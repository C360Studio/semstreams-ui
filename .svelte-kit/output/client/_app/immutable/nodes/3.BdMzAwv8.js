import{H as dr,b as vr,g as fr}from"../chunks/4LF6yYm1.js";import{h as cn,aJ as Vn,B as hr,aa as _r,aK as gr,aL as mr,aM as pr,D as le,aN as ta,aG as yr,F as Ea,C as Ta,l as Ie,aO as br,aw as Bt,aq as qt,aP as Ne,as as c,au as v,at as o,M as a,aH as rt,z as j,av as O,x as m,ar as Pt,az as st,O as Gt,ax as mn,al as Xt,y as C,Q as p,t as Et,v as gt,aQ as un,aR as he,a8 as Na,aS as Ve,aT as we,aU as ge,aV as Ee,aW as Pe,aA as Hn,aX as wr,aI as xr,u as kr,ay as Sr}from"../chunks/Mdsrn-sT.js";import"../chunks/DsnmJJEf.js";import{i as H}from"../chunks/DaqNudQJ.js";import{t as Cr,e as Ct,s as Ht,i as Er,a as ea}from"../chunks/BfTtFuzB.js";import{p as It,b as ne}from"../chunks/CWmhHnL_.js";import{s as U,r as re,a as Tr}from"../chunks/-vPpbTQc.js";function me(e,t,n,r){var i=e.__style;if(cn||i!==t){var s=Cr(t);(!cn||s!==e.getAttribute("style"))&&(s==null?e.removeAttribute("style"):e.style.cssText=s),e.__style=t}return r}function Aa(e,t,n=!1){if(e.multiple){if(t==null)return;if(!_r(t))return gr();for(var r of e.options)r.selected=t.includes(je(r));return}for(r of e.options){var i=je(r);if(mr(i,t)){r.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Nr(e){var t=new MutationObserver(()=>{Aa(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),pr(()=>{t.disconnect()})}function Me(e,t,n=t){var r=!0;Vn(e,"change",i=>{var s=i?"[selected]":":checked",l;if(e.multiple)l=[].map.call(e.querySelectorAll(s),je);else{var d=e.querySelector(s)??e.querySelector("option:not([disabled])");l=d&&je(d)}n(l)}),hr(()=>{var i=t();if(Aa(e,i,r),r&&i===void 0){var s=e.querySelector(":checked");s!==null&&(i=je(s),n(i))}e.__value=i,r=!1}),Nr(e)}function je(e){return"__value"in e?e.__value:e.value}function Se(e,t,n=t){var r=new WeakSet;Vn(e,"input",async i=>{le&&e.type==="checkbox"&&ta();var s=i?e.defaultValue:e.value;if(s=En(e)?Tn(s):s,n(s),Ie!==null&&r.add(Ie),await yr(),s!==(s=t())){var l=e.selectionStart,d=e.selectionEnd;e.value=s??"",d!==null&&(e.selectionStart=l,e.selectionEnd=Math.min(d,e.value.length))}}),(cn&&e.defaultValue!==e.value||Ea(t)==null&&e.value)&&(n(En(e)?Tn(e.value):e.value),Ie!==null&&r.add(Ie)),Ta(()=>{le&&e.type==="checkbox"&&ta();var i=t();if(e===document.activeElement){var s=br??Ie;if(r.has(s))return}En(e)&&i===Tn(e.value)||e.type==="date"&&!i&&!e.value||i!==e.value&&(e.value=i??"")})}function pn(e,t,n=t){Vn(e,"change",r=>{var i=r?e.defaultChecked:e.checked;n(i)}),(cn&&e.defaultChecked!==e.checked||Ea(t)==null)&&n(e.checked),Ta(()=>{var r=t();e.checked=!!r})}function En(e){var t=e.type;return t==="number"||t==="range"}function Tn(e){return e===""?null:+e}function Ar(e,t){throw le&&(isNaN(e)||e<400||e>599)?new Error(`HTTP error status codes must be between 400 and 599 â€” ${e} is invalid`):new dr(e,t)}const Mr=!1,zr=async({params:e,fetch:t})=>{const n=await t(`/flowbuilder/flows/${e.id}`);if(!n.ok)throw Ar(n.status,`Flow not found: ${e.id}`);const r=await n.json();return{flow:{...r,nodes:r.nodes||[],connections:r.connections||[]}}},tf=Object.freeze(Object.defineProperty({__proto__:null,load:zr,ssr:Mr},Symbol.toStringTag,{value:"Module"}));var Dr={value:()=>{}};function Bn(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new rn(n)}function rn(e){this._=e}function Rr(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}rn.prototype=Bn.prototype={constructor:rn,on:function(e,t){var n=this._,r=Rr(e+"",n),i,s=-1,l=r.length;if(arguments.length<2){for(;++s<l;)if((i=(e=r[s]).type)&&(i=qr(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++s<l;)if(i=(e=r[s]).type)n[i]=na(n[i],e.name,t);else if(t==null)for(i in n)n[i]=na(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new rn(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,s=r.length;i<s;++i)r[i].value.apply(t,n)}};function qr(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function na(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Dr,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var zn="http://www.w3.org/1999/xhtml";const aa={svg:"http://www.w3.org/2000/svg",xhtml:zn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function yn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),aa.hasOwnProperty(t)?{space:aa[t],local:e}:e}function Pr(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===zn&&t.documentElement.namespaceURI===zn?t.createElement(e):t.createElementNS(n,e)}}function Or(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ma(e){var t=yn(e);return(t.local?Or:Pr)(t)}function Ir(){}function jn(e){return e==null?Ir:function(){return this.querySelector(e)}}function Fr(e){typeof e!="function"&&(e=jn(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],l=s.length,d=r[i]=new Array(l),f,_,h=0;h<l;++h)(f=s[h])&&(_=e.call(f,f.__data__,h,s))&&("__data__"in f&&(_.__data__=f.__data__),d[h]=_);return new $t(r,this._parents)}function Lr(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Vr(){return[]}function za(e){return e==null?Vr:function(){return this.querySelectorAll(e)}}function Hr(e){return function(){return Lr(e.apply(this,arguments))}}function Br(e){typeof e=="function"?e=Hr(e):e=za(e);for(var t=this._groups,n=t.length,r=[],i=[],s=0;s<n;++s)for(var l=t[s],d=l.length,f,_=0;_<d;++_)(f=l[_])&&(r.push(e.call(f,f.__data__,_,l)),i.push(f));return new $t(r,i)}function Da(e){return function(){return this.matches(e)}}function Ra(e){return function(t){return t.matches(e)}}var jr=Array.prototype.find;function Xr(e){return function(){return jr.call(this.children,e)}}function Ur(){return this.firstElementChild}function Yr(e){return this.select(e==null?Ur:Xr(typeof e=="function"?e:Ra(e)))}var Wr=Array.prototype.filter;function Kr(){return Array.from(this.children)}function Gr(e){return function(){return Wr.call(this.children,e)}}function Jr(e){return this.selectAll(e==null?Kr:Gr(typeof e=="function"?e:Ra(e)))}function Zr(e){typeof e!="function"&&(e=Da(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],l=s.length,d=r[i]=[],f,_=0;_<l;++_)(f=s[_])&&e.call(f,f.__data__,_,s)&&d.push(f);return new $t(r,this._parents)}function qa(e){return new Array(e.length)}function Qr(){return new $t(this._enter||this._groups.map(qa),this._parents)}function dn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}dn.prototype={constructor:dn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function $r(e){return function(){return e}}function ti(e,t,n,r,i,s){for(var l=0,d,f=t.length,_=s.length;l<_;++l)(d=t[l])?(d.__data__=s[l],r[l]=d):n[l]=new dn(e,s[l]);for(;l<f;++l)(d=t[l])&&(i[l]=d)}function ei(e,t,n,r,i,s,l){var d,f,_=new Map,h=t.length,g=s.length,y=new Array(h),E;for(d=0;d<h;++d)(f=t[d])&&(y[d]=E=l.call(f,f.__data__,d,t)+"",_.has(E)?i[d]=f:_.set(E,f));for(d=0;d<g;++d)E=l.call(e,s[d],d,s)+"",(f=_.get(E))?(r[d]=f,f.__data__=s[d],_.delete(E)):n[d]=new dn(e,s[d]);for(d=0;d<h;++d)(f=t[d])&&_.get(y[d])===f&&(i[d]=f)}function ni(e){return e.__data__}function ai(e,t){if(!arguments.length)return Array.from(this,ni);var n=t?ei:ti,r=this._parents,i=this._groups;typeof e!="function"&&(e=$r(e));for(var s=i.length,l=new Array(s),d=new Array(s),f=new Array(s),_=0;_<s;++_){var h=r[_],g=i[_],y=g.length,E=ri(e.call(h,h&&h.__data__,_,r)),z=E.length,B=d[_]=new Array(z),q=l[_]=new Array(z),N=f[_]=new Array(y);n(h,g,B,q,N,E,t);for(var M=0,b=0,P,K;M<z;++M)if(P=B[M]){for(M>=b&&(b=M+1);!(K=q[b])&&++b<z;);P._next=K||null}}return l=new $t(l,r),l._enter=d,l._exit=f,l}function ri(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ii(){return new $t(this._exit||this._groups.map(qa),this._parents)}function si(e,t,n){var r=this.enter(),i=this,s=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function oi(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,s=r.length,l=Math.min(i,s),d=new Array(i),f=0;f<l;++f)for(var _=n[f],h=r[f],g=_.length,y=d[f]=new Array(g),E,z=0;z<g;++z)(E=_[z]||h[z])&&(y[z]=E);for(;f<i;++f)d[f]=n[f];return new $t(d,this._parents)}function li(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,s=r[i],l;--i>=0;)(l=r[i])&&(s&&l.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(l,s),s=l);return this}function ci(e){e||(e=ui);function t(g,y){return g&&y?e(g.__data__,y.__data__):!g-!y}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var l=n[s],d=l.length,f=i[s]=new Array(d),_,h=0;h<d;++h)(_=l[h])&&(f[h]=_);f.sort(t)}return new $t(i,this._parents).order()}function ui(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function di(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function vi(){return Array.from(this)}function fi(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length;i<s;++i){var l=r[i];if(l)return l}return null}function hi(){let e=0;for(const t of this)++e;return e}function _i(){return!this.node()}function gi(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],s=0,l=i.length,d;s<l;++s)(d=i[s])&&e.call(d,d.__data__,s,i);return this}function mi(e){return function(){this.removeAttribute(e)}}function pi(e){return function(){this.removeAttributeNS(e.space,e.local)}}function yi(e,t){return function(){this.setAttribute(e,t)}}function bi(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function wi(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function xi(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function ki(e,t){var n=yn(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?pi:mi:typeof t=="function"?n.local?xi:wi:n.local?bi:yi)(n,t))}function Pa(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Si(e){return function(){this.style.removeProperty(e)}}function Ci(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ei(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Ti(e,t,n){return arguments.length>1?this.each((t==null?Si:typeof t=="function"?Ei:Ci)(e,t,n??"")):Re(this.node(),e)}function Re(e,t){return e.style.getPropertyValue(t)||Pa(e).getComputedStyle(e,null).getPropertyValue(t)}function Ni(e){return function(){delete this[e]}}function Ai(e,t){return function(){this[e]=t}}function Mi(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function zi(e,t){return arguments.length>1?this.each((t==null?Ni:typeof t=="function"?Mi:Ai)(e,t)):this.node()[e]}function Oa(e){return e.trim().split(/^|\s+/)}function Xn(e){return e.classList||new Ia(e)}function Ia(e){this._node=e,this._names=Oa(e.getAttribute("class")||"")}Ia.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Fa(e,t){for(var n=Xn(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function La(e,t){for(var n=Xn(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function Di(e){return function(){Fa(this,e)}}function Ri(e){return function(){La(this,e)}}function qi(e,t){return function(){(t.apply(this,arguments)?Fa:La)(this,e)}}function Pi(e,t){var n=Oa(e+"");if(arguments.length<2){for(var r=Xn(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?qi:t?Di:Ri)(n,t))}function Oi(){this.textContent=""}function Ii(e){return function(){this.textContent=e}}function Fi(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Li(e){return arguments.length?this.each(e==null?Oi:(typeof e=="function"?Fi:Ii)(e)):this.node().textContent}function Vi(){this.innerHTML=""}function Hi(e){return function(){this.innerHTML=e}}function Bi(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ji(e){return arguments.length?this.each(e==null?Vi:(typeof e=="function"?Bi:Hi)(e)):this.node().innerHTML}function Xi(){this.nextSibling&&this.parentNode.appendChild(this)}function Ui(){return this.each(Xi)}function Yi(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Wi(){return this.each(Yi)}function Ki(e){var t=typeof e=="function"?e:Ma(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Gi(){return null}function Ji(e,t){var n=typeof e=="function"?e:Ma(e),r=t==null?Gi:typeof t=="function"?t:jn(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Zi(){var e=this.parentNode;e&&e.removeChild(this)}function Qi(){return this.each(Zi)}function $i(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ts(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function es(e){return this.select(e?ts:$i)}function ns(e){return arguments.length?this.property("__data__",e):this.node().__data__}function as(e){return function(t){e.call(this,t,this.__data__)}}function rs(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function is(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,s;n<i;++n)s=t[n],(!e.type||s.type===e.type)&&s.name===e.name?this.removeEventListener(s.type,s.listener,s.options):t[++r]=s;++r?t.length=r:delete this.__on}}}function ss(e,t,n){return function(){var r=this.__on,i,s=as(t);if(r){for(var l=0,d=r.length;l<d;++l)if((i=r[l]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=t;return}}this.addEventListener(e.type,s,n),i={type:e.type,name:e.name,value:t,listener:s,options:n},r?r.push(i):this.__on=[i]}}function os(e,t,n){var r=rs(e+""),i,s=r.length,l;if(arguments.length<2){var d=this.node().__on;if(d){for(var f=0,_=d.length,h;f<_;++f)for(i=0,h=d[f];i<s;++i)if((l=r[i]).type===h.type&&l.name===h.name)return h.value}return}for(d=t?ss:is,i=0;i<s;++i)this.each(d(r[i],t,n));return this}function Va(e,t,n){var r=Pa(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function ls(e,t){return function(){return Va(this,e,t)}}function cs(e,t){return function(){return Va(this,e,t.apply(this,arguments))}}function us(e,t){return this.each((typeof t=="function"?cs:ls)(e,t))}function*ds(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,s=r.length,l;i<s;++i)(l=r[i])&&(yield l)}var Ha=[null];function $t(e,t){this._groups=e,this._parents=t}function Ge(){return new $t([[document.documentElement]],Ha)}function vs(){return this}$t.prototype=Ge.prototype={constructor:$t,select:Fr,selectAll:Br,selectChild:Yr,selectChildren:Jr,filter:Zr,data:ai,enter:Qr,exit:ii,join:si,merge:oi,selection:vs,order:li,sort:ci,call:di,nodes:vi,node:fi,size:hi,empty:_i,each:gi,attr:ki,style:Ti,property:zi,classed:Pi,text:Li,html:ji,raise:Ui,lower:Wi,append:Ki,insert:Ji,remove:Qi,clone:es,datum:ns,on:os,dispatch:us,[Symbol.iterator]:ds};function ee(e){return typeof e=="string"?new $t([[document.querySelector(e)]],[document.documentElement]):new $t([[e]],Ha)}function fs(e){let t;for(;t=e.sourceEvent;)e=t;return e}function xe(e,t){if(e=fs(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const Dn={capture:!0,passive:!1};function Rn(e){e.preventDefault(),e.stopImmediatePropagation()}function hs(e){var t=e.document.documentElement,n=ee(e).on("dragstart.drag",Rn,Dn);"onselectstart"in t?n.on("selectstart.drag",Rn,Dn):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function _s(e,t){var n=e.document.documentElement,r=ee(e).on("dragstart.drag",null);t&&(r.on("click.drag",Rn,Dn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Un(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ba(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Je(){}var Xe=.7,vn=1/Xe,ze="\\s*([+-]?\\d+)\\s*",Ue="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ce="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gs=/^#([0-9a-f]{3,8})$/,ms=new RegExp(`^rgb\\(${ze},${ze},${ze}\\)$`),ps=new RegExp(`^rgb\\(${ce},${ce},${ce}\\)$`),ys=new RegExp(`^rgba\\(${ze},${ze},${ze},${Ue}\\)$`),bs=new RegExp(`^rgba\\(${ce},${ce},${ce},${Ue}\\)$`),ws=new RegExp(`^hsl\\(${Ue},${ce},${ce}\\)$`),xs=new RegExp(`^hsla\\(${Ue},${ce},${ce},${Ue}\\)$`),ra={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Un(Je,Ye,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:ia,formatHex:ia,formatHex8:ks,formatHsl:Ss,formatRgb:sa,toString:sa});function ia(){return this.rgb().formatHex()}function ks(){return this.rgb().formatHex8()}function Ss(){return ja(this).formatHsl()}function sa(){return this.rgb().formatRgb()}function Ye(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=gs.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?oa(t):n===3?new Jt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qe(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qe(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ms.exec(e))?new Jt(t[1],t[2],t[3],1):(t=ps.exec(e))?new Jt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ys.exec(e))?Qe(t[1],t[2],t[3],t[4]):(t=bs.exec(e))?Qe(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ws.exec(e))?ua(t[1],t[2]/100,t[3]/100,1):(t=xs.exec(e))?ua(t[1],t[2]/100,t[3]/100,t[4]):ra.hasOwnProperty(e)?oa(ra[e]):e==="transparent"?new Jt(NaN,NaN,NaN,0):null}function oa(e){return new Jt(e>>16&255,e>>8&255,e&255,1)}function Qe(e,t,n,r){return r<=0&&(e=t=n=NaN),new Jt(e,t,n,r)}function Cs(e){return e instanceof Je||(e=Ye(e)),e?(e=e.rgb(),new Jt(e.r,e.g,e.b,e.opacity)):new Jt}function qn(e,t,n,r){return arguments.length===1?Cs(e):new Jt(e,t,n,r??1)}function Jt(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Un(Jt,qn,Ba(Je,{brighter(e){return e=e==null?vn:Math.pow(vn,e),new Jt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Xe:Math.pow(Xe,e),new Jt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Jt(Ce(this.r),Ce(this.g),Ce(this.b),fn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:la,formatHex:la,formatHex8:Es,formatRgb:ca,toString:ca}));function la(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}`}function Es(){return`#${ke(this.r)}${ke(this.g)}${ke(this.b)}${ke((isNaN(this.opacity)?1:this.opacity)*255)}`}function ca(){const e=fn(this.opacity);return`${e===1?"rgb(":"rgba("}${Ce(this.r)}, ${Ce(this.g)}, ${Ce(this.b)}${e===1?")":`, ${e})`}`}function fn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ce(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ke(e){return e=Ce(e),(e<16?"0":"")+e.toString(16)}function ua(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ae(e,t,n,r)}function ja(e){if(e instanceof ae)return new ae(e.h,e.s,e.l,e.opacity);if(e instanceof Je||(e=Ye(e)),!e)return new ae;if(e instanceof ae)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),s=Math.max(t,n,r),l=NaN,d=s-i,f=(s+i)/2;return d?(t===s?l=(n-r)/d+(n<r)*6:n===s?l=(r-t)/d+2:l=(t-n)/d+4,d/=f<.5?s+i:2-s-i,l*=60):d=f>0&&f<1?0:l,new ae(l,d,f,e.opacity)}function Ts(e,t,n,r){return arguments.length===1?ja(e):new ae(e,t,n,r??1)}function ae(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Un(ae,Ts,Ba(Je,{brighter(e){return e=e==null?vn:Math.pow(vn,e),new ae(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Xe:Math.pow(Xe,e),new ae(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Jt(Nn(e>=240?e-240:e+120,i,r),Nn(e,i,r),Nn(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new ae(da(this.h),$e(this.s),$e(this.l),fn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=fn(this.opacity);return`${e===1?"hsl(":"hsla("}${da(this.h)}, ${$e(this.s)*100}%, ${$e(this.l)*100}%${e===1?")":`, ${e})`}`}}));function da(e){return e=(e||0)%360,e<0?e+360:e}function $e(e){return Math.max(0,Math.min(1,e||0))}function Nn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Xa=e=>()=>e;function Ns(e,t){return function(n){return e+n*t}}function As(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Ms(e){return(e=+e)==1?Ua:function(t,n){return n-t?As(t,n,e):Xa(isNaN(t)?n:t)}}function Ua(e,t){var n=t-e;return n?Ns(e,n):Xa(isNaN(e)?t:e)}const va=(function e(t){var n=Ms(t);function r(i,s){var l=n((i=qn(i)).r,(s=qn(s)).r),d=n(i.g,s.g),f=n(i.b,s.b),_=Ua(i.opacity,s.opacity);return function(h){return i.r=l(h),i.g=d(h),i.b=f(h),i.opacity=_(h),i+""}}return r.gamma=e,r})(1);function be(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Pn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,An=new RegExp(Pn.source,"g");function zs(e){return function(){return e}}function Ds(e){return function(t){return e(t)+""}}function Rs(e,t){var n=Pn.lastIndex=An.lastIndex=0,r,i,s,l=-1,d=[],f=[];for(e=e+"",t=t+"";(r=Pn.exec(e))&&(i=An.exec(t));)(s=i.index)>n&&(s=t.slice(n,s),d[l]?d[l]+=s:d[++l]=s),(r=r[0])===(i=i[0])?d[l]?d[l]+=i:d[++l]=i:(d[++l]=null,f.push({i:l,x:be(r,i)})),n=An.lastIndex;return n<t.length&&(s=t.slice(n),d[l]?d[l]+=s:d[++l]=s),d.length<2?f[0]?Ds(f[0].x):zs(t):(t=f.length,function(_){for(var h=0,g;h<t;++h)d[(g=f[h]).i]=g.x(_);return d.join("")})}var fa=180/Math.PI,On={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ya(e,t,n,r,i,s){var l,d,f;return(l=Math.sqrt(e*e+t*t))&&(e/=l,t/=l),(f=e*n+t*r)&&(n-=e*f,r-=t*f),(d=Math.sqrt(n*n+r*r))&&(n/=d,r/=d,f/=d),e*r<t*n&&(e=-e,t=-t,f=-f,l=-l),{translateX:i,translateY:s,rotate:Math.atan2(t,e)*fa,skewX:Math.atan(f)*fa,scaleX:l,scaleY:d}}var tn;function qs(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?On:Ya(t.a,t.b,t.c,t.d,t.e,t.f)}function Ps(e){return e==null||(tn||(tn=document.createElementNS("http://www.w3.org/2000/svg","g")),tn.setAttribute("transform",e),!(e=tn.transform.baseVal.consolidate()))?On:(e=e.matrix,Ya(e.a,e.b,e.c,e.d,e.e,e.f))}function Wa(e,t,n,r){function i(_){return _.length?_.pop()+" ":""}function s(_,h,g,y,E,z){if(_!==g||h!==y){var B=E.push("translate(",null,t,null,n);z.push({i:B-4,x:be(_,g)},{i:B-2,x:be(h,y)})}else(g||y)&&E.push("translate("+g+t+y+n)}function l(_,h,g,y){_!==h?(_-h>180?h+=360:h-_>180&&(_+=360),y.push({i:g.push(i(g)+"rotate(",null,r)-2,x:be(_,h)})):h&&g.push(i(g)+"rotate("+h+r)}function d(_,h,g,y){_!==h?y.push({i:g.push(i(g)+"skewX(",null,r)-2,x:be(_,h)}):h&&g.push(i(g)+"skewX("+h+r)}function f(_,h,g,y,E,z){if(_!==g||h!==y){var B=E.push(i(E)+"scale(",null,",",null,")");z.push({i:B-4,x:be(_,g)},{i:B-2,x:be(h,y)})}else(g!==1||y!==1)&&E.push(i(E)+"scale("+g+","+y+")")}return function(_,h){var g=[],y=[];return _=e(_),h=e(h),s(_.translateX,_.translateY,h.translateX,h.translateY,g,y),l(_.rotate,h.rotate,g,y),d(_.skewX,h.skewX,g,y),f(_.scaleX,_.scaleY,h.scaleX,h.scaleY,g,y),_=h=null,function(E){for(var z=-1,B=y.length,q;++z<B;)g[(q=y[z]).i]=q.x(E);return g.join("")}}}var Os=Wa(qs,"px, ","px)","deg)"),Is=Wa(Ps,", ",")",")"),Fs=1e-12;function ha(e){return((e=Math.exp(e))+1/e)/2}function Ls(e){return((e=Math.exp(e))-1/e)/2}function Vs(e){return((e=Math.exp(2*e))-1)/(e+1)}const Hs=(function e(t,n,r){function i(s,l){var d=s[0],f=s[1],_=s[2],h=l[0],g=l[1],y=l[2],E=h-d,z=g-f,B=E*E+z*z,q,N;if(B<Fs)N=Math.log(y/_)/t,q=function($){return[d+$*E,f+$*z,_*Math.exp(t*$*N)]};else{var M=Math.sqrt(B),b=(y*y-_*_+r*B)/(2*_*n*M),P=(y*y-_*_-r*B)/(2*y*n*M),K=Math.log(Math.sqrt(b*b+1)-b),G=Math.log(Math.sqrt(P*P+1)-P);N=(G-K)/t,q=function($){var L=$*N,W=ha(K),X=_/(n*M)*(W*Vs(t*L+K)-Ls(K));return[d+X*E,f+X*z,_*W/ha(t*L+K)]}}return q.duration=N*1e3*t/Math.SQRT2,q}return i.rho=function(s){var l=Math.max(.001,+s),d=l*l,f=d*d;return e(l,d,f)},i})(Math.SQRT2,2,4);var qe=0,He=0,Fe=0,Ka=1e3,hn,Be,_n=0,Te=0,bn=0,We=typeof performance=="object"&&performance.now?performance:Date,Ga=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Yn(){return Te||(Ga(Bs),Te=We.now()+bn)}function Bs(){Te=0}function gn(){this._call=this._time=this._next=null}gn.prototype=Ja.prototype={constructor:gn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Yn():+n)+(t==null?0:+t),!this._next&&Be!==this&&(Be?Be._next=this:hn=this,Be=this),this._call=e,this._time=n,In()},stop:function(){this._call&&(this._call=null,this._time=1/0,In())}};function Ja(e,t,n){var r=new gn;return r.restart(e,t,n),r}function js(){Yn(),++qe;for(var e=hn,t;e;)(t=Te-e._time)>=0&&e._call.call(void 0,t),e=e._next;--qe}function _a(){Te=(_n=We.now())+bn,qe=He=0;try{js()}finally{qe=0,Us(),Te=0}}function Xs(){var e=We.now(),t=e-_n;t>Ka&&(bn-=t,_n=e)}function Us(){for(var e,t=hn,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:hn=n);Be=e,In(r)}function In(e){if(!qe){He&&(He=clearTimeout(He));var t=e-Te;t>24?(e<1/0&&(He=setTimeout(_a,e-We.now()-bn)),Fe&&(Fe=clearInterval(Fe))):(Fe||(_n=We.now(),Fe=setInterval(Xs,Ka)),qe=1,Ga(_a))}}function ga(e,t,n){var r=new gn;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var Ys=Bn("start","end","cancel","interrupt"),Ws=[],Za=0,ma=1,Fn=2,sn=3,pa=4,Ln=5,on=6;function wn(e,t,n,r,i,s){var l=e.__transition;if(!l)e.__transition={};else if(n in l)return;Ks(e,n,{name:t,index:r,group:i,on:Ys,tween:Ws,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Za})}function Wn(e,t){var n=ie(e,t);if(n.state>Za)throw new Error("too late; already scheduled");return n}function ue(e,t){var n=ie(e,t);if(n.state>sn)throw new Error("too late; already running");return n}function ie(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Ks(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=Ja(s,0,n.time);function s(_){n.state=ma,n.timer.restart(l,n.delay,n.time),n.delay<=_&&l(_-n.delay)}function l(_){var h,g,y,E;if(n.state!==ma)return f();for(h in r)if(E=r[h],E.name===n.name){if(E.state===sn)return ga(l);E.state===pa?(E.state=on,E.timer.stop(),E.on.call("interrupt",e,e.__data__,E.index,E.group),delete r[h]):+h<t&&(E.state=on,E.timer.stop(),E.on.call("cancel",e,e.__data__,E.index,E.group),delete r[h])}if(ga(function(){n.state===sn&&(n.state=pa,n.timer.restart(d,n.delay,n.time),d(_))}),n.state=Fn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Fn){for(n.state=sn,i=new Array(y=n.tween.length),h=0,g=-1;h<y;++h)(E=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++g]=E);i.length=g+1}}function d(_){for(var h=_<n.duration?n.ease.call(null,_/n.duration):(n.timer.restart(f),n.state=Ln,1),g=-1,y=i.length;++g<y;)i[g].call(e,h);n.state===Ln&&(n.on.call("end",e,e.__data__,n.index,n.group),f())}function f(){n.state=on,n.timer.stop(),delete r[t];for(var _ in r)return;delete e.__transition}}function ln(e,t){var n=e.__transition,r,i,s=!0,l;if(n){t=t==null?null:t+"";for(l in n){if((r=n[l]).name!==t){s=!1;continue}i=r.state>Fn&&r.state<Ln,r.state=on,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[l]}s&&delete e.__transition}}function Gs(e){return this.each(function(){ln(this,e)})}function Js(e,t){var n,r;return function(){var i=ue(this,e),s=i.tween;if(s!==n){r=n=s;for(var l=0,d=r.length;l<d;++l)if(r[l].name===t){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function Zs(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=ue(this,e),l=s.tween;if(l!==r){i=(r=l).slice();for(var d={name:t,value:n},f=0,_=i.length;f<_;++f)if(i[f].name===t){i[f]=d;break}f===_&&i.push(d)}s.tween=i}}function Qs(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ie(this.node(),n).tween,i=0,s=r.length,l;i<s;++i)if((l=r[i]).name===e)return l.value;return null}return this.each((t==null?Js:Zs)(n,e,t))}function Kn(e,t,n){var r=e._id;return e.each(function(){var i=ue(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return ie(i,r).value[t]}}function Qa(e,t){var n;return(typeof t=="number"?be:t instanceof Ye?va:(n=Ye(t))?(t=n,va):Rs)(e,t)}function $s(e){return function(){this.removeAttribute(e)}}function to(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eo(e,t,n){var r,i=n+"",s;return function(){var l=this.getAttribute(e);return l===i?null:l===r?s:s=t(r=l,n)}}function no(e,t,n){var r,i=n+"",s;return function(){var l=this.getAttributeNS(e.space,e.local);return l===i?null:l===r?s:s=t(r=l,n)}}function ao(e,t,n){var r,i,s;return function(){var l,d=n(this),f;return d==null?void this.removeAttribute(e):(l=this.getAttribute(e),f=d+"",l===f?null:l===r&&f===i?s:(i=f,s=t(r=l,d)))}}function ro(e,t,n){var r,i,s;return function(){var l,d=n(this),f;return d==null?void this.removeAttributeNS(e.space,e.local):(l=this.getAttributeNS(e.space,e.local),f=d+"",l===f?null:l===r&&f===i?s:(i=f,s=t(r=l,d)))}}function io(e,t){var n=yn(e),r=n==="transform"?Is:Qa;return this.attrTween(e,typeof t=="function"?(n.local?ro:ao)(n,r,Kn(this,"attr."+e,t)):t==null?(n.local?to:$s)(n):(n.local?no:eo)(n,r,t))}function so(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function oo(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function lo(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&oo(e,s)),n}return i._value=t,i}function co(e,t){var n,r;function i(){var s=t.apply(this,arguments);return s!==r&&(n=(r=s)&&so(e,s)),n}return i._value=t,i}function uo(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=yn(e);return this.tween(n,(r.local?lo:co)(r,t))}function vo(e,t){return function(){Wn(this,e).delay=+t.apply(this,arguments)}}function fo(e,t){return t=+t,function(){Wn(this,e).delay=t}}function ho(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?vo:fo)(t,e)):ie(this.node(),t).delay}function _o(e,t){return function(){ue(this,e).duration=+t.apply(this,arguments)}}function go(e,t){return t=+t,function(){ue(this,e).duration=t}}function mo(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?_o:go)(t,e)):ie(this.node(),t).duration}function po(e,t){if(typeof t!="function")throw new Error;return function(){ue(this,e).ease=t}}function yo(e){var t=this._id;return arguments.length?this.each(po(t,e)):ie(this.node(),t).ease}function bo(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;ue(this,e).ease=n}}function wo(e){if(typeof e!="function")throw new Error;return this.each(bo(this._id,e))}function xo(e){typeof e!="function"&&(e=Da(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var s=t[i],l=s.length,d=r[i]=[],f,_=0;_<l;++_)(f=s[_])&&e.call(f,f.__data__,_,s)&&d.push(f);return new pe(r,this._parents,this._name,this._id)}function ko(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,s=Math.min(r,i),l=new Array(r),d=0;d<s;++d)for(var f=t[d],_=n[d],h=f.length,g=l[d]=new Array(h),y,E=0;E<h;++E)(y=f[E]||_[E])&&(g[E]=y);for(;d<r;++d)l[d]=t[d];return new pe(l,this._parents,this._name,this._id)}function So(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Co(e,t,n){var r,i,s=So(t)?Wn:ue;return function(){var l=s(this,e),d=l.on;d!==r&&(i=(r=d).copy()).on(t,n),l.on=i}}function Eo(e,t){var n=this._id;return arguments.length<2?ie(this.node(),n).on.on(e):this.each(Co(n,e,t))}function To(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function No(){return this.on("end.remove",To(this._id))}function Ao(e){var t=this._name,n=this._id;typeof e!="function"&&(e=jn(e));for(var r=this._groups,i=r.length,s=new Array(i),l=0;l<i;++l)for(var d=r[l],f=d.length,_=s[l]=new Array(f),h,g,y=0;y<f;++y)(h=d[y])&&(g=e.call(h,h.__data__,y,d))&&("__data__"in h&&(g.__data__=h.__data__),_[y]=g,wn(_[y],t,n,y,_,ie(h,n)));return new pe(s,this._parents,t,n)}function Mo(e){var t=this._name,n=this._id;typeof e!="function"&&(e=za(e));for(var r=this._groups,i=r.length,s=[],l=[],d=0;d<i;++d)for(var f=r[d],_=f.length,h,g=0;g<_;++g)if(h=f[g]){for(var y=e.call(h,h.__data__,g,f),E,z=ie(h,n),B=0,q=y.length;B<q;++B)(E=y[B])&&wn(E,t,n,B,y,z);s.push(y),l.push(h)}return new pe(s,l,t,n)}var zo=Ge.prototype.constructor;function Do(){return new zo(this._groups,this._parents)}function Ro(e,t){var n,r,i;return function(){var s=Re(this,e),l=(this.style.removeProperty(e),Re(this,e));return s===l?null:s===n&&l===r?i:i=t(n=s,r=l)}}function $a(e){return function(){this.style.removeProperty(e)}}function qo(e,t,n){var r,i=n+"",s;return function(){var l=Re(this,e);return l===i?null:l===r?s:s=t(r=l,n)}}function Po(e,t,n){var r,i,s;return function(){var l=Re(this,e),d=n(this),f=d+"";return d==null&&(f=d=(this.style.removeProperty(e),Re(this,e))),l===f?null:l===r&&f===i?s:(i=f,s=t(r=l,d))}}function Oo(e,t){var n,r,i,s="style."+t,l="end."+s,d;return function(){var f=ue(this,e),_=f.on,h=f.value[s]==null?d||(d=$a(t)):void 0;(_!==n||i!==h)&&(r=(n=_).copy()).on(l,i=h),f.on=r}}function Io(e,t,n){var r=(e+="")=="transform"?Os:Qa;return t==null?this.styleTween(e,Ro(e,r)).on("end.style."+e,$a(e)):typeof t=="function"?this.styleTween(e,Po(e,r,Kn(this,"style."+e,t))).each(Oo(this._id,e)):this.styleTween(e,qo(e,r,t),n).on("end.style."+e,null)}function Fo(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function Lo(e,t,n){var r,i;function s(){var l=t.apply(this,arguments);return l!==i&&(r=(i=l)&&Fo(e,l,n)),r}return s._value=t,s}function Vo(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,Lo(e,t,n??""))}function Ho(e){return function(){this.textContent=e}}function Bo(e){return function(){var t=e(this);this.textContent=t??""}}function jo(e){return this.tween("text",typeof e=="function"?Bo(Kn(this,"text",e)):Ho(e==null?"":e+""))}function Xo(e){return function(t){this.textContent=e.call(this,t)}}function Uo(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&Xo(i)),t}return r._value=e,r}function Yo(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Uo(e))}function Wo(){for(var e=this._name,t=this._id,n=tr(),r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],d=l.length,f,_=0;_<d;++_)if(f=l[_]){var h=ie(f,t);wn(f,e,n,_,l,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new pe(r,this._parents,e,n)}function Ko(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(s,l){var d={value:l},f={value:function(){--i===0&&s()}};n.each(function(){var _=ue(this,r),h=_.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(d),t._.interrupt.push(d),t._.end.push(f)),_.on=t}),i===0&&s()})}var Go=0;function pe(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function tr(){return++Go}var fe=Ge.prototype;pe.prototype={constructor:pe,select:Ao,selectAll:Mo,selectChild:fe.selectChild,selectChildren:fe.selectChildren,filter:xo,merge:ko,selection:Do,transition:Wo,call:fe.call,nodes:fe.nodes,node:fe.node,size:fe.size,empty:fe.empty,each:fe.each,on:Eo,attr:io,attrTween:uo,style:Io,styleTween:Vo,text:jo,textTween:Yo,remove:No,tween:Qs,delay:ho,duration:mo,ease:yo,easeVarying:wo,end:Ko,[Symbol.iterator]:fe[Symbol.iterator]};function Jo(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Zo={time:null,delay:0,duration:250,ease:Jo};function Qo(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function $o(e){var t,n;e instanceof pe?(t=e._id,e=e._name):(t=tr(),(n=Zo).time=Yn(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var l=r[s],d=l.length,f,_=0;_<d;++_)(f=l[_])&&wn(f,e,t,_,l,n||Qo(f,t));return new pe(r,this._parents,e,t)}Ge.prototype.interrupt=Gs;Ge.prototype.transition=$o;const en=e=>()=>e;function tl(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function _e(e,t,n){this.k=e,this.x=t,this.y=n}_e.prototype={constructor:_e,scale:function(e){return e===1?this:new _e(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new _e(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Gn=new _e(1,0,0);_e.prototype;function Mn(e){e.stopImmediatePropagation()}function Le(e){e.preventDefault(),e.stopImmediatePropagation()}function el(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function nl(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ya(){return this.__zoom||Gn}function al(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function rl(){return navigator.maxTouchPoints||"ontouchstart"in this}function il(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],s=e.invertY(t[0][1])-n[0][1],l=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),l>s?(s+l)/2:Math.min(0,s)||Math.max(0,l))}function sl(){var e=el,t=nl,n=il,r=al,i=rl,s=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],d=250,f=Hs,_=Bn("start","zoom","end"),h,g,y,E=500,z=150,B=0,q=10;function N(u){u.property("__zoom",ya).on("wheel.zoom",L,{passive:!1}).on("mousedown.zoom",W).on("dblclick.zoom",X).filter(i).on("touchstart.zoom",F).on("touchmove.zoom",A).on("touchend.zoom touchcancel.zoom",x).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.transform=function(u,S,w,T){var k=u.selection?u.selection():u;k.property("__zoom",ya),u!==k?K(u,S,w,T):k.interrupt().each(function(){G(this,arguments).event(T).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},N.scaleBy=function(u,S,w,T){N.scaleTo(u,function(){var k=this.__zoom.k,D=typeof S=="function"?S.apply(this,arguments):S;return k*D},w,T)},N.scaleTo=function(u,S,w,T){N.transform(u,function(){var k=t.apply(this,arguments),D=this.__zoom,R=w==null?P(k):typeof w=="function"?w.apply(this,arguments):w,V=D.invert(R),tt=typeof S=="function"?S.apply(this,arguments):S;return n(b(M(D,tt),R,V),k,l)},w,T)},N.translateBy=function(u,S,w,T){N.transform(u,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof w=="function"?w.apply(this,arguments):w),t.apply(this,arguments),l)},null,T)},N.translateTo=function(u,S,w,T,k){N.transform(u,function(){var D=t.apply(this,arguments),R=this.__zoom,V=T==null?P(D):typeof T=="function"?T.apply(this,arguments):T;return n(Gn.translate(V[0],V[1]).scale(R.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof w=="function"?-w.apply(this,arguments):-w),D,l)},T,k)};function M(u,S){return S=Math.max(s[0],Math.min(s[1],S)),S===u.k?u:new _e(S,u.x,u.y)}function b(u,S,w){var T=S[0]-w[0]*u.k,k=S[1]-w[1]*u.k;return T===u.x&&k===u.y?u:new _e(u.k,T,k)}function P(u){return[(+u[0][0]+ +u[1][0])/2,(+u[0][1]+ +u[1][1])/2]}function K(u,S,w,T){u.on("start.zoom",function(){G(this,arguments).event(T).start()}).on("interrupt.zoom end.zoom",function(){G(this,arguments).event(T).end()}).tween("zoom",function(){var k=this,D=arguments,R=G(k,D).event(T),V=t.apply(k,D),tt=w==null?P(V):typeof w=="function"?w.apply(k,D):w,nt=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),at=k.__zoom,ot=typeof S=="function"?S.apply(k,D):S,I=f(at.invert(tt).concat(nt/at.k),ot.invert(tt).concat(nt/ot.k));return function(Y){if(Y===1)Y=ot;else{var lt=I(Y),Q=nt/lt[2];Y=new _e(Q,tt[0]-lt[0]*Q,tt[1]-lt[1]*Q)}R.zoom(null,Y)}})}function G(u,S,w){return!w&&u.__zooming||new $(u,S)}function $(u,S){this.that=u,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(u,S),this.taps=0}$.prototype={event:function(u){return u&&(this.sourceEvent=u),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(u,S){return this.mouse&&u!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&u!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&u!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(u){var S=ee(this.that).datum();_.call(u,this.that,new tl(u,{sourceEvent:this.sourceEvent,target:N,transform:this.that.__zoom,dispatch:_}),S)}};function L(u,...S){if(!e.apply(this,arguments))return;var w=G(this,S).event(u),T=this.__zoom,k=Math.max(s[0],Math.min(s[1],T.k*Math.pow(2,r.apply(this,arguments)))),D=xe(u);if(w.wheel)(w.mouse[0][0]!==D[0]||w.mouse[0][1]!==D[1])&&(w.mouse[1]=T.invert(w.mouse[0]=D)),clearTimeout(w.wheel);else{if(T.k===k)return;w.mouse=[D,T.invert(D)],ln(this),w.start()}Le(u),w.wheel=setTimeout(R,z),w.zoom("mouse",n(b(M(T,k),w.mouse[0],w.mouse[1]),w.extent,l));function R(){w.wheel=null,w.end()}}function W(u,...S){if(y||!e.apply(this,arguments))return;var w=u.currentTarget,T=G(this,S,!0).event(u),k=ee(u.view).on("mousemove.zoom",tt,!0).on("mouseup.zoom",nt,!0),D=xe(u,w),R=u.clientX,V=u.clientY;hs(u.view),Mn(u),T.mouse=[D,this.__zoom.invert(D)],ln(this),T.start();function tt(at){if(Le(at),!T.moved){var ot=at.clientX-R,I=at.clientY-V;T.moved=ot*ot+I*I>B}T.event(at).zoom("mouse",n(b(T.that.__zoom,T.mouse[0]=xe(at,w),T.mouse[1]),T.extent,l))}function nt(at){k.on("mousemove.zoom mouseup.zoom",null),_s(at.view,T.moved),Le(at),T.event(at).end()}}function X(u,...S){if(e.apply(this,arguments)){var w=this.__zoom,T=xe(u.changedTouches?u.changedTouches[0]:u,this),k=w.invert(T),D=w.k*(u.shiftKey?.5:2),R=n(b(M(w,D),T,k),t.apply(this,S),l);Le(u),d>0?ee(this).transition().duration(d).call(K,R,T,u):ee(this).call(N.transform,R,T,u)}}function F(u,...S){if(e.apply(this,arguments)){var w=u.touches,T=w.length,k=G(this,S,u.changedTouches.length===T).event(u),D,R,V,tt;for(Mn(u),R=0;R<T;++R)V=w[R],tt=xe(V,this),tt=[tt,this.__zoom.invert(tt),V.identifier],k.touch0?!k.touch1&&k.touch0[2]!==tt[2]&&(k.touch1=tt,k.taps=0):(k.touch0=tt,D=!0,k.taps=1+!!h);h&&(h=clearTimeout(h)),D&&(k.taps<2&&(g=tt[0],h=setTimeout(function(){h=null},E)),ln(this),k.start())}}function A(u,...S){if(this.__zooming){var w=G(this,S).event(u),T=u.changedTouches,k=T.length,D,R,V,tt;for(Le(u),D=0;D<k;++D)R=T[D],V=xe(R,this),w.touch0&&w.touch0[2]===R.identifier?w.touch0[0]=V:w.touch1&&w.touch1[2]===R.identifier&&(w.touch1[0]=V);if(R=w.that.__zoom,w.touch1){var nt=w.touch0[0],at=w.touch0[1],ot=w.touch1[0],I=w.touch1[1],Y=(Y=ot[0]-nt[0])*Y+(Y=ot[1]-nt[1])*Y,lt=(lt=I[0]-at[0])*lt+(lt=I[1]-at[1])*lt;R=M(R,Math.sqrt(Y/lt)),V=[(nt[0]+ot[0])/2,(nt[1]+ot[1])/2],tt=[(at[0]+I[0])/2,(at[1]+I[1])/2]}else if(w.touch0)V=w.touch0[0],tt=w.touch0[1];else return;w.zoom("touch",n(b(R,V,tt),w.extent,l))}}function x(u,...S){if(this.__zooming){var w=G(this,S).event(u),T=u.changedTouches,k=T.length,D,R;for(Mn(u),y&&clearTimeout(y),y=setTimeout(function(){y=null},E),D=0;D<k;++D)R=T[D],w.touch0&&w.touch0[2]===R.identifier?delete w.touch0:w.touch1&&w.touch1[2]===R.identifier&&delete w.touch1;if(w.touch1&&!w.touch0&&(w.touch0=w.touch1,delete w.touch1),w.touch0)w.touch0[1]=this.__zoom.invert(w.touch0[0]);else if(w.end(),w.taps===2&&(R=xe(R,this),Math.hypot(g[0]-R[0],g[1]-R[1])<q)){var V=ee(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return N.wheelDelta=function(u){return arguments.length?(r=typeof u=="function"?u:en(+u),N):r},N.filter=function(u){return arguments.length?(e=typeof u=="function"?u:en(!!u),N):e},N.touchable=function(u){return arguments.length?(i=typeof u=="function"?u:en(!!u),N):i},N.extent=function(u){return arguments.length?(t=typeof u=="function"?u:en([[+u[0][0],+u[0][1]],[+u[1][0],+u[1][1]]]),N):t},N.scaleExtent=function(u){return arguments.length?(s[0]=+u[0],s[1]=+u[1],N):[s[0],s[1]]},N.translateExtent=function(u){return arguments.length?(l[0][0]=+u[0][0],l[1][0]=+u[1][0],l[0][1]=+u[0][1],l[1][1]=+u[1][1],N):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},N.constrain=function(u){return arguments.length?(n=u,N):n},N.duration=function(u){return arguments.length?(d=+u,N):d},N.interpolate=function(u){return arguments.length?(f=u,N):f},N.on=function(){var u=_.on.apply(_,arguments);return u===_?N:u},N.clickDistance=function(u){return arguments.length?(B=(u=+u)*u,N):Math.sqrt(B)},N.tapDistance=function(u){return arguments.length?(q=+u,N):q},N}const ol={nodeWidth:200,nodeHeight:80,horizontalSpacing:100,verticalSpacing:60,padding:50};function ll(e,t,n={}){const r={...ol,...n};if(e.length===0)return[];const i=new Map,s=new Map;for(const g of e)i.set(g.id,[]),s.set(g.id,[]);for(const g of t){const y=i.get(g.target_node_id);y&&y.push(g.source_node_id);const E=s.get(g.source_node_id);E&&E.push(g.target_node_id)}const l=new Map,d=new Set;function f(g){if(l.has(g))return l.get(g);if(d.has(g))return 0;d.add(g);const y=i.get(g)||[];if(y.length===0)return l.set(g,0),0;const z=Math.max(...y.map(B=>f(B)))+1;return l.set(g,z),z}for(const g of e)f(g.id);const _=new Map;for(const g of e){const y=l.get(g.id)||0;_.has(y)||_.set(y,[]),_.get(y).push(g)}const h=[];for(const[g,y]of _){const E=r.padding+g*(r.nodeWidth+r.horizontalSpacing);y.forEach((z,B)=>{const q=r.padding+B*(r.nodeHeight+r.verticalSpacing);h.push({id:z.id,type:z.type,name:z.name,x:E,y:q,width:r.nodeWidth,height:r.nodeHeight,config:z.config,original:z})})}return h}function cl(e,t){const n=new Map;for(const r of t)n.set(r.id,r);return e.map(r=>{const i=n.get(r.source_node_id),s=n.get(r.target_node_id);if(!i||!s)return null;const l=i.x+i.width,d=i.y+i.height/2,f=s.x,_=s.y+s.height/2;return{id:r.id,sourceNodeId:r.source_node_id,sourcePort:r.source_port,targetNodeId:r.target_node_id,targetPort:r.target_port,sourceX:l,sourceY:d,targetX:f,targetY:_,original:r}}).filter(r=>r!==null)}function ul(e,t=50){if(e.length===0)return{width:800,height:600};let n=0,r=0;for(const i of e)n=Math.max(n,i.x+i.width),r=Math.max(r,i.y+i.height);return{width:n+t,height:r+t}}function dl(e,t={}){const{minZoom:n=.1,maxZoom:r=2}=t;return sl().scaleExtent([n,r]).on("zoom",i=>{e(i.transform)})}function vl(e,t){ee(e).call(t)}function fl(e,t,n,r,i,s=50){const l=Math.min((r-s*2)/n.width,(i-s*2)/n.height,1),d=(r-n.width*l)/2,f=(i-n.height*l)/2,_=Gn.translate(d,f).scale(l),h=ee(e),g=h.transition();typeof g.duration=="function"?g.duration(300).call(t.transform,_):h.call(t.transform,_)}const hl={robotics:{color:"var(--domain-robotics)",label:"Robotics",description:"Autonomous vehicles and MAVLink processing"},semantic:{color:"var(--domain-semantic)",label:"Semantic Processing",description:"Knowledge graphs, rules, and reasoning"},network:{color:"var(--domain-network)",label:"Network I/O",description:"Data ingestion and output (UDP, WebSocket, HTTP)"},storage:{color:"var(--domain-storage)",label:"Storage",description:"Data persistence and retrieval"},telemetry:{color:"var(--domain-telemetry)",label:"Telemetry",description:"Metrics and observability"},geospatial:{color:"var(--domain-geospatial)",label:"Geospatial",description:"GIS, mapping, and location services"},media:{color:"var(--domain-media)",label:"Media",description:"Video, audio, and image processing"},integration:{color:"var(--domain-integration)",label:"Integration",description:"External system connectors"}};function Jn(e){return hl[e]?.color||"var(--ui-border-subtle)"}const _l={nats_stream:"var(--port-pattern-stream)",nats_request:"var(--port-pattern-request)",kv_watch:"var(--port-pattern-watch)",network:"var(--port-pattern-api)",file:"var(--port-pattern-file)"},ba={required:"solid",optional:"dashed"},gl={nats_stream:"arrow-path-rounded-square",nats_request:"arrow-path",kv_watch:"eye",network:"server",file:"document-text"};function wa(e){let t;switch(e.pattern){case"stream":t="nats_stream";break;case"request":t="nats_request";break;case"watch":t="kv_watch";break;case"api":t="network";break;default:e.connection_id?.startsWith("file://")?t="file":t="network"}const n=_l[t],r=e.required?ba.required:ba.optional,i=gl[t],s=t.replace("_"," "),l=e.direction==="input"?"Input":"Output",d=e.required?"required":"optional",f=`${s} ${l}: ${e.name} (${d})`,_=["port-handle",`port-${t}`,`port-${r}`];return{color:n,borderPattern:r,iconName:i,ariaLabel:f,cssClasses:_}}function ml(e,t){t.onclick?.(t.node.id)}function pl(e,t){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t.onclick?.(t.node.id))}var yl=Ne('<circle stroke-width="2"><title> </title></circle>'),bl=Ne('<circle stroke-width="2"><title> </title></circle>'),wl=Ne('<g role="button" tabindex="0"><rect class="node-background svelte-12wvdkg" x="0" y="0" rx="8" ry="8"></rect><rect class="node-accent" x="0" y="0" rx="8" ry="0"></rect><rect class="node-accent-cover" y="0" width="4"></rect><text class="node-label svelte-12wvdkg" y="24"> </text><text class="node-type svelte-12wvdkg" y="42"> </text><text class="port-summary svelte-12wvdkg"> </text><!><!></g>');function xl(e,t){qt(t,!0);let n=It(t,"inputPorts",19,()=>[]),r=It(t,"outputPorts",19,()=>[]),i=It(t,"selected",3,!1);const s=rt(()=>Jn(t.node.type||"network")),l=20,d=6,f=4,_=rt(()=>n().map((L,W)=>({port:L,x:0,y:30+W*l,style:wa(L)}))),h=rt(()=>r().map((L,W)=>({port:L,x:t.node.width,y:30+W*l,style:wa(L)})));var g=wl();let y;g.__click=[ml,t],g.__keydown=[pl,t];var E=c(g),z=v(E);U(z,"width",f);var B=v(z);U(B,"x",f-2);var q=v(B);U(q,"x",f+12);var N=c(q,!0);o(q);var M=v(q);U(M,"x",f+12);var b=c(M,!0);o(M);var P=v(M);U(P,"x",f+12);var K=c(P);o(P);var G=v(P);Ct(G,17,()=>a(_),({port:L,x:W,y:X,style:F})=>L.name,(L,W)=>{let X=()=>a(W).port,F=()=>a(W).x,A=()=>a(W).y,x=()=>a(W).style;var u=yl();let S;U(u,"r",d);var w=c(u),T=c(w);o(w),o(u),j(k=>{S=Ht(u,0,"port port-input svelte-12wvdkg",null,S,k),U(u,"data-port-name",X().name),U(u,"cx",F()),U(u,"cy",A()),U(u,"fill",X().required?x().color:"var(--pico-background-color)"),U(u,"stroke",x().color),O(T,`${X().name??""} (${X().required?"required":"optional"})`)},[()=>({"port-required":X().required})]),m(L,u)});var $=v(G);Ct($,17,()=>a(h),({port:L,x:W,y:X,style:F})=>L.name,(L,W)=>{let X=()=>a(W).port,F=()=>a(W).x,A=()=>a(W).y,x=()=>a(W).style;var u=bl();let S;U(u,"r",d);var w=c(u),T=c(w);o(w),o(u),j(k=>{S=Ht(u,0,"port port-output svelte-12wvdkg",null,S,k),U(u,"data-port-name",X().name),U(u,"cx",F()),U(u,"cy",A()),U(u,"fill",X().required?x().color:"var(--pico-background-color)"),U(u,"stroke",x().color),O(T,`${X().name??""} (${X().required?"required":"optional"})`)},[()=>({"port-required":X().required})]),m(L,u)}),o(g),j(L=>{y=Ht(g,0,"flow-node svelte-12wvdkg",null,y,L),U(g,"data-node-id",t.node.id),U(g,"data-node-type",t.node.type),U(g,"transform",`translate(${t.node.x??""}, ${t.node.y??""})`),U(g,"aria-label",`Flow node: ${t.node.name??""}. Click to edit.`),U(E,"width",t.node.width),U(E,"height",t.node.height),U(z,"height",t.node.height),U(z,"fill",a(s)),U(B,"height",t.node.height),U(B,"fill",a(s)),O(N,t.node.name),O(b,t.node.type),U(P,"y",t.node.height-12),O(K,`${n().length??""} in, ${r().length??""} out`)},[()=>({selected:i()})]),m(e,g),Pt()}Bt(["click","keydown"]);const nn={valid:{stroke:"var(--pico-primary)",strokeWidth:2,strokeDasharray:"",showArrow:!0},error:{stroke:"var(--pico-del-color, #c62828)",strokeWidth:2,strokeDasharray:"5,5",showArrow:!0},warning:{stroke:"var(--pico-mark-background-color, #ff9800)",strokeWidth:2,strokeDasharray:"5,5",showArrow:!0},auto:{stroke:"var(--pico-secondary)",strokeWidth:2,strokeDasharray:"3,3",showArrow:!0}};function kl(e,t,n,r){const i=Math.abs(n-e),s=Math.min(i*.5,100),l=e+s,d=t,f=n-s;return`M ${e} ${t} C ${l} ${d}, ${f} ${r}, ${n} ${r}`}function Sl(e){return kl(e.sourceX,e.sourceY,e.targetX,e.targetY)}function Cl(e){const t=e.original;return t.validationState==="error"?nn.error:t.validationState==="warning"?nn.warning:t.source==="auto"?nn.auto:nn.valid}var El=Ne("<title> </title>"),Tl=Ne('<g><circle class="edge-status-indicator svelte-17hph7n" r="8"></circle><text class="edge-status-icon svelte-17hph7n" text-anchor="middle" dominant-baseline="central" fill="white" font-size="12"> </text><!></g>'),Nl=Ne('<g><path class="edge-hitbox" stroke="transparent" stroke-width="20" fill="none"></path><path class="edge-path svelte-17hph7n" fill="none"></path><!></g>');function Al(e,t){qt(t,!0);let n=It(t,"selected",3,!1),r=It(t,"markerId",3,"arrow");const i=rt(()=>Sl(t.edge)),s=rt(()=>Cl(t.edge)),l=rt(()=>t.edge.original.source==="auto");var d=Nl();let f;var _=c(d),h=v(_),g=v(h);{var y=E=>{const z=rt(()=>(t.edge.sourceX+t.edge.targetX)/2),B=rt(()=>(t.edge.sourceY+t.edge.targetY)/2);var q=Tl(),N=c(q),M=v(N),b=c(M,!0);o(M);var P=v(M);{var K=G=>{var $=El(),L=c($,!0);o($),j(()=>O(L,t.edge.original.validationMessage)),m(G,$)};H(P,G=>{t.edge.original.validationMessage&&G(K)})}o(q),j(()=>{U(q,"transform",`translate(${a(z)??""}, ${a(B)??""})`),U(N,"fill",t.edge.original.validationState==="error"?"var(--pico-del-color)":"var(--pico-mark-background-color)"),O(b,t.edge.original.validationState==="error"?"!":"?")}),m(E,q)};H(g,E=>{(t.edge.original.validationState==="error"||t.edge.original.validationState==="warning")&&E(y)})}o(d),j(E=>{f=Ht(d,0,"flow-edge svelte-17hph7n",null,f,E),U(d,"data-connection-id",t.edge.id),U(d,"data-source",a(l)?"auto":"manual"),U(_,"d",a(i)),U(h,"d",a(i)),U(h,"stroke",a(s).stroke),U(h,"stroke-width",a(s).strokeWidth),U(h,"stroke-dasharray",a(s).strokeDasharray),U(h,"marker-end",a(s).showArrow?`url(#${r()})`:void 0)},[()=>({selected:n(),auto:a(l)})]),m(e,d),Pt()}var Ml=Ne('<marker viewBox="0 0 10 10" refX="9" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z"></path></marker>'),zl=C('<div class="empty-state svelte-5kezjk"><p class="svelte-5kezjk">No components in this flow.</p> <p class="hint svelte-5kezjk">Add components using the sidebar or describe your flow to the AI.</p></div>'),Dl=C('<div class="flow-canvas-container svelte-5kezjk"><svg id="flow-canvas" class="flow-canvas svelte-5kezjk" role="img" aria-label="Flow diagram"><defs></defs><g class="canvas-content"><defs><pattern id="grid" width="20" height="20" patternUnits="userSpaceOnUse"><path d="M 20 0 L 0 0 0 20" fill="none" stroke="var(--pico-muted-border-color)" stroke-width="0.5" opacity="0.5"></path></pattern></defs><rect x="-5000" y="-5000" width="10000" height="10000" fill="url(#grid)"></rect><!><!></g></svg> <div class="canvas-controls svelte-5kezjk"><button type="button" class="control-button svelte-5kezjk" aria-label="Zoom in">+</button> <button type="button" class="control-button svelte-5kezjk" aria-label="Zoom out">âˆ’</button> <button type="button" class="control-button svelte-5kezjk" aria-label="Fit to content">âŠ¡</button></div> <!></div>');function Rl(e,t){qt(t,!0);let n=It(t,"portsMap",19,()=>({})),r=It(t,"selectedNodeId",3,null),i,s,l=st(Gt({x:0,y:0,k:1}));const d=rt(()=>ll(t.nodes,t.connections)),f=rt(()=>cl(t.connections,a(d))),_=rt(()=>ul(a(d)));let h=null;mn(()=>{h=dl(x=>{p(l,{x:x.x,y:x.y,k:x.k},!0)}),vl(i,h),requestAnimationFrame(()=>{g()});let F=null;const A=()=>{F!==null&&clearTimeout(F),F=setTimeout(()=>{g(),F=null},200)};return window.addEventListener("resize",A),()=>{if(window.removeEventListener("resize",A),F!==null&&clearTimeout(F),i&&h)try{const x=ee(i);x&&typeof x.on=="function"&&x.on(".zoom",null)}catch(x){console.debug("D3 zoom cleanup skipped:",x)}}}),Xt(()=>{if(t.nodes.length>0&&h&&i&&s){const F=setTimeout(()=>{g()},100);return()=>clearTimeout(F)}});function g(){if(!i||!s||!h)return;const F=s.getBoundingClientRect();fl(i,h,a(_),F.width,F.height)}function y(F){t.onNodeClick?.(F)}function E(F){const A=n()[F];return{input:A?.input_ports||[],output:A?.output_ports||[]}}const z=[{id:"arrow-default",color:"var(--pico-primary)"},{id:"arrow-error",color:"var(--pico-del-color)"},{id:"arrow-warning",color:"var(--pico-mark-background-color)"},{id:"arrow-auto",color:"var(--pico-secondary)"}];var B=Dl(),q=c(B),N=c(q);Ct(N,21,()=>z,F=>F.id,(F,A)=>{var x=Ml(),u=c(x);o(x),j(()=>{U(x,"id",a(A).id),U(u,"fill",a(A).color)}),m(F,x)}),o(N);var M=v(N),b=v(c(M),2);Ct(b,17,()=>a(f),F=>F.id,(F,A)=>{Al(F,{get edge(){return a(A)},markerId:"arrow-default"})});var P=v(b);Ct(P,17,()=>a(d),F=>F.id,(F,A)=>{const x=rt(()=>E(a(A).id));{let u=rt(()=>r()===a(A).id);xl(F,{get node(){return a(A)},get inputPorts(){return a(x).input},get outputPorts(){return a(x).output},get selected(){return a(u)},onclick:y})}}),o(M),o(q),ne(q,F=>i=F,()=>i);var K=v(q,2),G=c(K);G.__click=()=>{i&&h&&ee(i).transition().call(h.scaleBy,1.2)};var $=v(G,2);$.__click=()=>{i&&h&&ee(i).transition().call(h.scaleBy,.8)};var L=v($,2);L.__click=g,o(K);var W=v(K,2);{var X=F=>{var A=zl();m(F,A)};H(W,F=>{t.nodes.length===0&&F(X)})}o(B),ne(B,F=>s=F,()=>s),j(()=>U(M,"transform",`translate(${a(l).x??""}, ${a(l).y??""}) scale(${a(l).k??""})`)),m(e,B),Pt()}Bt(["click"]);function ql(e){const t=e.toLowerCase();return t.includes("mavlink")||t.includes("telemetry")||t.includes("drone")||t.includes("vehicle")?"robotics":t.includes("udp")||t.includes("websocket")||t.includes("http")||t.includes("tcp")||t.includes("input")||t.includes("output")?"network":t.includes("json")||t.includes("transform")||t.includes("processor")||t.includes("filter")||t.includes("parser")||t.includes("semantic")||t.includes("rule")?"semantic":t.includes("storage")||t.includes("database")||t.includes("writer")||t.includes("reader")||t.includes("persist")?"storage":t.includes("geo")||t.includes("map")||t.includes("location")||t.includes("gis")?"geospatial":t.includes("video")||t.includes("audio")||t.includes("image")||t.includes("media")?"media":t.includes("api")||t.includes("connector")||t.includes("integration")?"integration":"network"}function Pl(e,t){t.onSelect?.()}function Ol(e,t){(e.key==="Enter"||e.key===" ")&&(e.preventDefault(),t.onSelect?.())}function Il(e,t){e.stopPropagation(),t.onEdit?.()}function Fl(e,t){e.stopPropagation(),t.onDelete?.()}var Ll=C('<div role="button" tabindex="0"><div class="card-content svelte-2nqj9l"><div class="card-header svelte-2nqj9l"><h4 class="component-name svelte-2nqj9l"> </h4></div> <div class="component-type svelte-2nqj9l"> </div></div> <div class="card-actions svelte-2nqj9l"><button class="action-button edit-button svelte-2nqj9l" title="Edit component">âš™ï¸</button> <button class="action-button delete-button svelte-2nqj9l" title="Delete component">ðŸ—‘ï¸</button></div></div>');function Vl(e,t){qt(t,!0);let n=It(t,"selected",3,!1);const r=rt(()=>Jn(ql(t.node.type)));var i=Ll();let s;i.__click=[Pl,t],i.__keydown=[Ol,t];var l=c(i),d=c(l),f=c(d),_=c(f,!0);o(f),o(d);var h=v(d,2),g=c(h);o(h),o(l);var y=v(l,2),E=c(y);E.__click=[Il,t];var z=v(E,2);z.__click=[Fl,t],o(y),o(i),j(B=>{s=Ht(i,1,"component-card svelte-2nqj9l",null,s,B),me(i,`border-left: 4px solid ${a(r)??""}`),U(i,"aria-label",t.node.name),U(i,"aria-pressed",n()),O(_,t.node.name||t.node.id),O(g,`Type: ${t.node.type??""}`),U(E,"aria-label",`Edit ${t.node.name??""}`),U(z,"aria-label",`Delete ${t.node.name??""}`)},[()=>({selected:n()})]),m(e,i),Pt()}Bt(["click","keydown"]);function Hl(e,t){t.onAddComponent?.()}var Bl=C('<div class="empty-state svelte-i468xr"><p class="empty-message svelte-i468xr">No components yet</p> <p class="empty-hint svelte-i468xr">Add a component to get started</p></div>'),jl=C('<div class="empty-state svelte-i468xr"><p class="empty-message svelte-i468xr">No components found</p> <p class="empty-hint svelte-i468xr">Try a different search term</p></div>'),Xl=C('<li role="listitem" class="svelte-i468xr"><!></li>'),Ul=C('<ul class="component-list-items svelte-i468xr" role="list" aria-live="polite"></ul>'),Yl=C('<div class="component-list svelte-i468xr"><header class="list-header svelte-i468xr"><h3 class="svelte-i468xr"> </h3> <button class="add-button svelte-i468xr" aria-label="Add component" title="Add new component">+ Add</button></header> <div class="search-section svelte-i468xr"><label for="component-search" class="visually-hidden svelte-i468xr">Search components</label> <input id="component-search" type="text" class="search-input svelte-i468xr" placeholder="Search components..." aria-label="Search components"/></div> <div class="list-content svelte-i468xr"><!></div></div>');function Wl(e,t){qt(t,!0);let n=It(t,"selectedNodeId",3,null),r=st("");const i=rt(()=>{if(!a(r).trim())return t.nodes;const b=a(r).toLowerCase().trim();return t.nodes.filter(P=>P.name.toLowerCase().includes(b)||P.type.toLowerCase().includes(b))});function s(b){t.onSelectNode?.(b)}function l(b){t.onEditNode?.(b)}function d(b){t.onDeleteNode?.(b)}var f=Yl(),_=c(f),h=c(_),g=c(h);o(h);var y=v(h,2);y.__click=[Hl,t],o(_);var E=v(_,2),z=v(c(E),2);re(z),o(E);var B=v(E,2),q=c(B);{var N=b=>{var P=Bl();m(b,P)},M=b=>{var P=Et(),K=gt(P);{var G=L=>{var W=jl();m(L,W)},$=L=>{var W=Ul();Ct(W,21,()=>a(i),X=>X.id,(X,F)=>{var A=Xl(),x=c(A);{let u=rt(()=>a(F).id===n());Vl(x,{get node(){return a(F)},get selected(){return a(u)},onSelect:()=>s(a(F).id),onEdit:()=>l(a(F).id),onDelete:()=>d(a(F).id)})}o(A),m(X,A)}),o(W),m(L,W)};H(K,L=>{a(i).length===0?L(G):L($,!1)},!0)}m(b,P)};H(q,b=>{t.nodes.length===0?b(N):b(M,!1)})}o(B),o(f),j(()=>O(g,`Components (${a(i).length??""})`)),Se(z,()=>a(r),b=>p(r,b)),m(e,f),Pt()}Bt(["click"]);var Kl=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],Gl=["difference","intersection","symmetricDifference","union"],xa=!1;class Ke extends Set{#n=new Map;#t=st(0);#e=st(0);#i=un||-1;constructor(t){if(super(),le&&(t=new Set(t),he(this.#t,"SvelteSet version"),he(this.#e,"SvelteSet.size")),t){for(var n of t)super.add(n);this.#e.v=super.size}xa||this.#r()}#a(t){return un===this.#i?st(t):Na(t)}#r(){xa=!0;var t=Ke.prototype,n=Set.prototype;for(const r of Kl)t[r]=function(...i){return a(this.#t),n[r].apply(this,i)};for(const r of Gl)t[r]=function(...i){a(this.#t);var s=n[r].apply(this,i);return new Ke(s)}}has(t){var n=super.has(t),r=this.#n,i=r.get(t);if(i===void 0){if(!n)return a(this.#t),!1;i=this.#a(!0),le&&he(i,`SvelteSet has(${Ve(t)})`),r.set(t,i)}return a(i),n}add(t){return super.has(t)||(super.add(t),p(this.#e,super.size),we(this.#t)),this}delete(t){var n=super.delete(t),r=this.#n,i=r.get(t);return i!==void 0&&(r.delete(t),p(i,!1)),n&&(p(this.#e,super.size),we(this.#t)),n}clear(){if(super.size!==0){super.clear();var t=this.#n;for(var n of t.values())p(n,!1);t.clear(),p(this.#e,0),we(this.#t)}}keys(){return this.values()}values(){return a(this.#t),super.values()}entries(){return a(this.#t),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return a(this.#e)}}class De extends Map{#n=new Map;#t=st(0);#e=st(0);#i=un||-1;constructor(t){if(super(),le&&(t=new Map(t),he(this.#t,"SvelteMap version"),he(this.#e,"SvelteMap.size")),t){for(var[n,r]of t)super.set(n,r);this.#e.v=super.size}}#a(t){return un===this.#i?st(t):Na(t)}has(t){var n=this.#n,r=n.get(t);if(r===void 0){var i=super.get(t);if(i!==void 0)r=this.#a(0),le&&he(r,`SvelteMap get(${Ve(t)})`),n.set(t,r);else return a(this.#t),!1}return a(r),!0}forEach(t,n){this.#r(),super.forEach(t,n)}get(t){var n=this.#n,r=n.get(t);if(r===void 0){var i=super.get(t);if(i!==void 0)r=this.#a(0),le&&he(r,`SvelteMap get(${Ve(t)})`),n.set(t,r);else{a(this.#t);return}}return a(r),super.get(t)}set(t,n){var r=this.#n,i=r.get(t),s=super.get(t),l=super.set(t,n),d=this.#t;if(i===void 0)i=this.#a(0),le&&he(i,`SvelteMap get(${Ve(t)})`),r.set(t,i),p(this.#e,super.size),we(d);else if(s!==n){we(i);var f=d.reactions===null?null:new Set(d.reactions),_=f===null||!i.reactions?.every(h=>f.has(h));_&&we(d)}return l}delete(t){var n=this.#n,r=n.get(t),i=super.delete(t);return r!==void 0&&(n.delete(t),p(this.#e,super.size),p(r,-1),we(this.#t)),i}clear(){if(super.size!==0){super.clear();var t=this.#n;p(this.#e,0);for(var n of t.values())p(n,-1);we(this.#t),t.clear()}}#r(){a(this.#t);var t=this.#n;if(this.#e.v!==t.size){for(var n of super.keys())if(!t.has(n)){var r=this.#a(0);le&&he(r,`SvelteMap get(${Ve(n)})`),t.set(n,r)}}for([,r]of this.#n)a(r)}keys(){return a(this.#t),super.keys()}values(){return this.#r(),super.values()}entries(){return this.#r(),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return a(this.#e),super.size}}var Jl=C('<div class="loading svelte-f0ohny">Loading components...</div>'),Zl=C('<div class="error svelte-f0ohny"> </div>'),Ql=C('<div class="empty svelte-f0ohny"><p class="svelte-f0ohny">Component palette coming soon</p> <p class="empty-hint svelte-f0ohny">Component types will be loaded from the registry</p></div>'),$l=(e,t,n)=>t(a(n)),tc=(e,t,n)=>t(e,a(n)),ec=C('<div class="component-card svelte-f0ohny" draggable="true" role="button" tabindex="0"><div class="component-name svelte-f0ohny"> </div> <div class="component-description svelte-f0ohny"> </div> <div class="component-meta svelte-f0ohny"><span class="component-protocol svelte-f0ohny"> </span></div></div>'),nc=C('<div class="category svelte-f0ohny"><div class="category-header svelte-f0ohny"> </div> <div class="component-list svelte-f0ohny"></div></div>'),ac=C('<div class="component-palette svelte-f0ohny"><header class="svelte-f0ohny"><h3 class="svelte-f0ohny">Components</h3></header> <div class="palette-content svelte-f0ohny"><!></div></div>');function rc(e,t){qt(t,!0);let n=st(Gt([])),r=st(!0),i=st(null);const s=rt(()=>{const z=new De;return a(n).forEach(B=>{const q=B.category||"other";z.has(q)||z.set(q,[]),z.get(q).push(B)}),z});mn(async()=>{try{const z=new AbortController,B=setTimeout(()=>z.abort(),1e4),q=await fetch("/components/types",{signal:z.signal});if(clearTimeout(B),!q.ok)throw new Error(`Failed to fetch components: ${q.statusText}`);const N=await q.json();p(n,Array.isArray(N)?N:[],!0)}catch(z){Er(z)?p(i,"Cannot connect to backend. Please ensure the backend service is running."):z instanceof Error?z.name==="AbortError"?p(i,"Request timed out. The backend may be slow or unavailable."):p(i,z.message,!0):p(i,"Unexpected error loading components"),console.error("ComponentPalette fetch error:",z)}finally{p(r,!1)}});function l(z,B){z.dataTransfer&&(z.dataTransfer.setData("application/json",JSON.stringify(B)),z.dataTransfer.effectAllowed="copy")}function d(z){t.onAddComponent?.(z)}function f(z,B){(z.key==="Enter"||z.key===" ")&&(z.preventDefault(),t.onAddComponent?.(B))}var _=ac(),h=v(c(_),2),g=c(h);{var y=z=>{var B=Jl();m(z,B)},E=z=>{var B=Et(),q=gt(B);{var N=b=>{var P=Zl(),K=c(P);o(P),j(()=>O(K,`Error loading components: ${a(i)??""}`)),m(b,P)},M=b=>{var P=Et(),K=gt(P);{var G=L=>{var W=Ql();m(L,W)},$=L=>{var W=Et(),X=gt(W);Ct(X,17,()=>[...a(s)],([F,A])=>F,(F,A)=>{var x=rt(()=>Ee(a(A),2));let u=()=>a(x)[0],S=()=>a(x)[1];var w=nc(),T=c(w),k=c(T,!0);o(T);var D=v(T,2);Ct(D,21,S,R=>R.id,(R,V)=>{const tt=rt(()=>Jn(a(V).category||u()));var nt=ec();nt.__dblclick=[$l,d,V],nt.__keydown=[tc,f,V];var at=c(nt),ot=c(at,!0);o(at);var I=v(at,2),Y=c(I,!0);o(I);var lt=v(I,2),Q=c(lt),et=c(Q,!0);o(Q),o(lt),o(nt),j(()=>{U(nt,"data-component-id",a(V).id),U(nt,"data-component-name",a(V).name),U(nt,"aria-label",`${a(V).name}: ${a(V).description}. Drag to canvas, double-click, or press Enter to add.`),me(nt,`border-left: var(--palette-domain-stripe-width) solid ${a(tt)??""};`),O(ot,a(V).name),O(Y,a(V).description),O(et,a(V).protocol)}),ge("dragstart",nt,ct=>l(ct,a(V))),m(R,nt)}),o(D),o(w),j(()=>O(k,u())),m(F,w)}),m(L,W)};H(K,L=>{a(n).length===0?L(G):L($,!1)},!0)}m(b,P)};H(q,b=>{a(i)?b(N):b(M,!1)},!0)}m(z,B)};H(g,z=>{a(r)?z(y):z(E,!1)})}o(h),o(_),m(e,_),Pt()}Bt(["dblclick","keydown"]);function ic(e,t,n,r,i){p(t,""),p(n,""),p(r,{},!0),p(i,!1)}function sc(e,t){e.target===e.currentTarget&&t()}function oc(e,t,n,r,i,s,l,d){!a(t)||!a(n)||(r.onAdd?.(a(n),a(i),a(s)),p(l,""),p(i,""),p(s,{},!0),p(d,!1))}var lc=(e,t)=>e.key==="Escape"&&t(),cc=e=>e.stopPropagation(),uc=C('<div class="palette-container svelte-vzgcpf"><!></div>'),dc=C('<span class="required svelte-vzgcpf">*</span>'),vc=C('<p class="field-description svelte-vzgcpf"> </p>'),fc=C('<input type="text" class="svelte-vzgcpf"/>'),hc=C('<input type="number" class="svelte-vzgcpf"/>'),_c=C('<input type="checkbox" class="svelte-vzgcpf"/>'),gc=C('<div class="validation-error svelte-vzgcpf"> </div>'),mc=C('<div class="form-group svelte-vzgcpf"><label class="svelte-vzgcpf"> <!></label> <!> <!> <!></div>'),pc=C('<div class="config-section svelte-vzgcpf"><h3 class="svelte-vzgcpf">Configuration</h3> <!></div>'),yc=C('<form><button type="button" class="back-button svelte-vzgcpf">â† Change component type</button> <div class="selected-type svelte-vzgcpf"><span class="type-label svelte-vzgcpf">Selected:</span> <span class="type-name svelte-vzgcpf"> </span></div> <div class="form-group svelte-vzgcpf"><label for="name" class="svelte-vzgcpf">Component Name</label> <input id="name" name="name" type="text" required aria-required="true" placeholder="Enter component name" class="svelte-vzgcpf"/></div> <!></form>'),bc=C('<button class="primary-button svelte-vzgcpf">Add Component</button>'),wc=C('<div class="dialog-overlay svelte-vzgcpf" role="dialog" aria-modal="true" aria-labelledby="dialog-title" tabindex="-1"><div class="dialog-content svelte-vzgcpf"><header class="dialog-header svelte-vzgcpf"><h2 id="dialog-title" class="svelte-vzgcpf">Add Component</h2> <button class="close-button svelte-vzgcpf" aria-label="Close dialog">Ã—</button></header> <div class="dialog-body svelte-vzgcpf"><!></div> <footer class="dialog-footer svelte-vzgcpf"><button class="secondary-button svelte-vzgcpf">Cancel</button> <!></footer></div></div>');function xc(e,t){qt(t,!0);let n=st(""),r=st(""),i=st(Gt({})),s=st(!1),l=st(void 0);function d(q){p(n,q.id,!0)}const f=rt(()=>t.componentTypes.find(q=>q.id===a(n))||null);Xt(()=>{if(a(n)&&!a(r)&&!a(s)){const q=Date.now(),N=a(n).replace(/[^a-z0-9-_]/gi,"-");p(r,`${N}-${q}`),p(s,!0)}}),Xt(()=>{if(a(f)?.configSchema){const q={};Object.entries(a(f).configSchema.properties).forEach(([N,M])=>{M.default!==void 0&&(q[N]=M.default)}),p(i,q,!0)}else p(i,{},!0)});const _=rt(()=>{if(!a(n)||!a(r).trim())return!1;if(a(f)?.configSchema){const q=a(f).configSchema.required||[];for(const N of q){const M=a(i)[N];if(M==null||M==="")return!1;const b=a(f).configSchema.properties[N];if(b.type==="number"){const P=Number(M);if(isNaN(P)||b.minimum!==void 0&&P<b.minimum||b.maximum!==void 0&&P>b.maximum)return!1}}}return!0});function h(q,N){const M=a(i)[q];if(M==null||M==="")return null;if(N.type==="number"){const b=Number(M);if(isNaN(b))return"Must be a valid number";if(N.minimum!==void 0&&b<N.minimum)return`Value must be at minimum ${N.minimum}`;if(N.maximum!==void 0&&b>N.maximum)return`Value must be at maximum ${N.maximum}`}return null}function g(q){q.key==="Escape"&&t.isOpen&&y()}function y(){p(n,""),p(r,""),p(i,{},!0),p(s,!1),t.onClose?.()}Xt(()=>{t.isOpen&&a(l)&&a(l).querySelector("select")?.focus()});var E=Et();ge("keydown",Pe,g);var z=gt(E);{var B=q=>{var N=wc();N.__click=[sc,y],N.__keydown=[lc,y];var M=c(N);M.__click=[cc];var b=c(M),P=v(c(b),2);P.__click=y,o(b);var K=v(b,2),G=c(K);{var $=x=>{var u=uc(),S=c(u);rc(S,{onAddComponent:d}),o(u),m(x,u)},L=x=>{var u=yc(),S=c(u);S.__click=[ic,n,r,i,s];var w=v(S,2),T=v(c(w),2),k=c(T,!0);o(T),o(w);var D=v(w,2),R=v(c(D),2);re(R),o(D);var V=v(D,2);{var tt=nt=>{var at=pc(),ot=v(c(at),2);Ct(ot,17,()=>Object.entries(a(f).configSchema.properties),([I,Y])=>I,(I,Y)=>{var lt=rt(()=>Ee(a(Y),2));let Q=()=>a(lt)[0],et=()=>a(lt)[1];const ct=rt(()=>a(f).configSchema.required?.includes(Q())),mt=rt(()=>h(Q(),et()));var Z=mc(),dt=c(Z),ht=c(dt),_t=v(ht);{var xt=ft=>{var it=dc();m(ft,it)};H(_t,ft=>{a(ct)&&ft(xt)})}o(dt);var Tt=v(dt,2);{var Dt=ft=>{var it=vc(),vt=c(it,!0);o(it),j(()=>O(vt,et().description)),m(ft,it)};H(Tt,ft=>{et().description&&ft(Dt)})}var jt=v(Tt,2);{var Ft=ft=>{var it=fc();re(it),j(()=>{U(it,"id",`config.${Q()??""}`),U(it,"name",`config.${Q()??""}`),it.required=a(ct),U(it,"aria-required",a(ct)),U(it,"aria-invalid",a(mt)!==null)}),Se(it,()=>a(i)[Q()],vt=>a(i)[Q()]=vt),m(ft,it)},Yt=ft=>{var it=Et(),vt=gt(it);{var pt=Ot=>{var wt=hc();re(wt),j(()=>{U(wt,"id",`config.${Q()??""}`),U(wt,"name",`config.${Q()??""}`),wt.required=a(ct),U(wt,"aria-required",a(ct)),U(wt,"aria-invalid",a(mt)!==null),U(wt,"min",et().minimum),U(wt,"max",et().maximum)}),Se(wt,()=>a(i)[Q()],Nt=>a(i)[Q()]=Nt),m(Ot,wt)},Rt=Ot=>{var wt=Et(),Nt=gt(wt);{var At=St=>{var bt=_c();re(bt),j(()=>{U(bt,"id",`config.${Q()??""}`),U(bt,"name",`config.${Q()??""}`)}),pn(bt,()=>a(i)[Q()],zt=>a(i)[Q()]=zt),m(St,bt)};H(Nt,St=>{et().type==="boolean"&&St(At)},!0)}m(Ot,wt)};H(vt,Ot=>{et().type==="number"?Ot(pt):Ot(Rt,!1)},!0)}m(ft,it)};H(jt,ft=>{et().type==="string"?ft(Ft):ft(Yt,!1)})}var Lt=v(jt,2);{var Mt=ft=>{var it=gc(),vt=c(it,!0);o(it),j(()=>O(vt,a(mt))),m(ft,it)};H(Lt,ft=>{a(mt)&&ft(Mt)})}o(Z),j(()=>{U(dt,"for",`config.${Q()??""}`),O(ht,`${Q()??""} `)}),m(I,Z)}),o(at),m(nt,at)};H(V,nt=>{a(f)?.configSchema&&nt(tt)})}o(u),j(()=>O(k,a(f)?.name)),ge("submit",u,nt=>nt.preventDefault()),Se(R,()=>a(r),nt=>p(r,nt)),m(x,u)};H(G,x=>{a(n)?x(L,!1):x($)})}o(K);var W=v(K,2),X=c(W);X.__click=y;var F=v(X,2);{var A=x=>{var u=bc();u.__click=[oc,_,f,t,r,i,n,s],j(()=>u.disabled=!a(_)),m(x,u)};H(F,x=>{a(n)&&x(A)})}o(W),o(M),o(N),ne(N,x=>p(l,x),()=>a(l)),m(q,N)};H(z,q=>{t.isOpen&&q(B)})}m(e,E),Pt()}Bt(["click","keydown"]);function kc(e,t){e.target===e.currentTarget&&t()}function Sc(e,t,n,r,i){!a(t)||!n.node||n.onSave?.(n.node.id,a(r),a(i))}function Cc(e,t){p(t,!0)}function Ec(e,t,n){t.node&&(t.onDelete?.(t.node.id),p(n,!1))}var Tc=(e,t)=>e.key==="Escape"&&t(),Nc=e=>e.stopPropagation(),Ac=C('<span class="required svelte-nf8lkk">*</span>'),Mc=C('<p class="field-description svelte-nf8lkk"> </p>'),zc=C('<input type="text" class="svelte-nf8lkk"/>'),Dc=C('<input type="number" class="svelte-nf8lkk"/>'),Rc=C('<input type="checkbox" class="svelte-nf8lkk"/>'),qc=C('<div class="validation-error svelte-nf8lkk"> </div>'),Pc=C('<div class="form-group svelte-nf8lkk"><label class="svelte-nf8lkk"> <!></label> <!> <!> <!></div>'),Oc=C('<div class="config-section svelte-nf8lkk"><h3 class="svelte-nf8lkk">Configuration</h3> <!></div>'),Ic=(e,t)=>e.key==="Escape"&&t(),Fc=e=>e.stopPropagation(),Lc=C('<div class="confirm-dialog svelte-nf8lkk" role="alertdialog" aria-modal="true" tabindex="-1"><div class="confirm-content svelte-nf8lkk"><h3 class="svelte-nf8lkk">Confirm Deletion</h3> <p class="svelte-nf8lkk"> </p> <p class="confirm-warning svelte-nf8lkk">This action cannot be undone.</p> <div class="confirm-actions svelte-nf8lkk"><button class="cancel-delete-button svelte-nf8lkk">Cancel</button> <button class="confirm-delete-button svelte-nf8lkk">Delete</button></div></div></div>'),Vc=C('<div class="dialog-overlay svelte-nf8lkk" role="dialog" aria-modal="true" aria-labelledby="dialog-title" tabindex="-1"><div class="dialog-content svelte-nf8lkk"><header class="dialog-header svelte-nf8lkk"><h2 id="dialog-title" class="svelte-nf8lkk"> </h2> <button class="close-button svelte-nf8lkk" aria-label="Close dialog">Ã—</button></header> <div class="dialog-body svelte-nf8lkk"><form><div class="form-group svelte-nf8lkk"><label for="name" class="svelte-nf8lkk">Component Name</label> <input id="name" name="name" type="text" required aria-required="true" placeholder="Enter component name" class="svelte-nf8lkk"/></div> <div class="form-group svelte-nf8lkk"><span class="form-label svelte-nf8lkk">Component Type</span> <div class="component-type-readonly svelte-nf8lkk"> </div></div> <!></form></div> <footer class="dialog-footer svelte-nf8lkk"><button class="danger-button svelte-nf8lkk">Delete</button> <div class="footer-right svelte-nf8lkk"><button class="secondary-button svelte-nf8lkk">Cancel</button> <button class="primary-button svelte-nf8lkk">Save</button></div></footer></div></div> <!>',1);function Hc(e,t){qt(t,!0);let n=st(""),r=st(Gt({})),i=st(!1),s=st(void 0);Xt(()=>{t.node?(p(n,t.node.name,!0),p(r,{...t.node.config},!0)):(p(n,""),p(r,{},!0)),p(i,!1)});const l=rt(()=>{if(!t.node)return!1;if(a(n)!==t.node.name)return!0;const q=t.node.config,N=Object.keys(a(r)),M=Object.keys(q);if(N.length!==M.length)return!0;for(const b of N)if(a(r)[b]!==q[b])return!0;return!1}),d=rt(()=>{if(!a(n).trim())return!1;if(t.componentType?.configSchema){const q=t.componentType.configSchema.required||[];for(const N of q){const M=a(r)[N];if(M==null||M==="")return!1;const b=t.componentType.configSchema.properties[N];if(b.type==="number"){const P=Number(M);if(isNaN(P)||b.minimum!==void 0&&P<b.minimum||b.maximum!==void 0&&P>b.maximum)return!1}}}return!0}),f=rt(()=>a(d)&&a(l));function _(q,N){const M=a(r)[q];if(M==null||M==="")return null;if(N.type==="number"){const b=Number(M);if(isNaN(b))return"Must be a valid number";if(N.minimum!==void 0&&b<N.minimum)return`Value must be at minimum ${N.minimum}`;if(N.maximum!==void 0&&b>N.maximum)return`Value must be at maximum ${N.maximum}`}return null}function h(q){q.key==="Escape"&&t.isOpen&&(a(i)?p(i,!1):y())}function g(){p(i,!1)}function y(){t.onClose?.()}Xt(()=>{t.isOpen&&a(s)&&t.node&&a(s).querySelector('input[name="name"]')?.focus()});var E=Et();ge("keydown",Pe,h);var z=gt(E);{var B=q=>{var N=Vc(),M=gt(N);M.__click=[kc,y],M.__keydown=[Tc,y];var b=c(M);b.__click=[Nc];var P=c(b),K=c(P),G=c(K);o(K);var $=v(K,2);$.__click=y,o(P);var L=v(P,2),W=c(L),X=c(W),F=v(c(X),2);re(F),o(X);var A=v(X,2),x=v(c(A),2),u=c(x);o(x),o(A);var S=v(A,2);{var w=at=>{var ot=Oc(),I=v(c(ot),2);Ct(I,17,()=>Object.entries(t.componentType.configSchema.properties),([Y,lt])=>Y,(Y,lt)=>{var Q=rt(()=>Ee(a(lt),2));let et=()=>a(Q)[0],ct=()=>a(Q)[1];const mt=rt(()=>t.componentType.configSchema.required?.includes(et())),Z=rt(()=>_(et(),ct()));var dt=Pc(),ht=c(dt),_t=c(ht),xt=v(_t);{var Tt=it=>{var vt=Ac();m(it,vt)};H(xt,it=>{a(mt)&&it(Tt)})}o(ht);var Dt=v(ht,2);{var jt=it=>{var vt=Mc(),pt=c(vt,!0);o(vt),j(()=>O(pt,ct().description)),m(it,vt)};H(Dt,it=>{ct().description&&it(jt)})}var Ft=v(Dt,2);{var Yt=it=>{var vt=zc();re(vt),j(()=>{U(vt,"id",`config.${et()??""}`),U(vt,"name",`config.${et()??""}`),vt.required=a(mt),U(vt,"aria-required",a(mt)),U(vt,"aria-invalid",a(Z)!==null)}),Se(vt,()=>a(r)[et()],pt=>a(r)[et()]=pt),m(it,vt)},Lt=it=>{var vt=Et(),pt=gt(vt);{var Rt=wt=>{var Nt=Dc();re(Nt),j(()=>{U(Nt,"id",`config.${et()??""}`),U(Nt,"name",`config.${et()??""}`),Nt.required=a(mt),U(Nt,"aria-required",a(mt)),U(Nt,"aria-invalid",a(Z)!==null),U(Nt,"min",ct().minimum),U(Nt,"max",ct().maximum)}),Se(Nt,()=>a(r)[et()],At=>a(r)[et()]=At),m(wt,Nt)},Ot=wt=>{var Nt=Et(),At=gt(Nt);{var St=bt=>{var zt=Rc();re(zt),j(()=>{U(zt,"id",`config.${et()??""}`),U(zt,"name",`config.${et()??""}`)}),pn(zt,()=>a(r)[et()],Vt=>a(r)[et()]=Vt),m(bt,zt)};H(At,bt=>{ct().type==="boolean"&&bt(St)},!0)}m(wt,Nt)};H(pt,wt=>{ct().type==="number"?wt(Rt):wt(Ot,!1)},!0)}m(it,vt)};H(Ft,it=>{ct().type==="string"?it(Yt):it(Lt,!1)})}var Mt=v(Ft,2);{var ft=it=>{var vt=qc(),pt=c(vt,!0);o(vt),j(()=>O(pt,a(Z))),m(it,vt)};H(Mt,it=>{a(Z)&&it(ft)})}o(dt),j(()=>{U(ht,"for",`config.${et()??""}`),O(_t,`${et()??""} `)}),m(Y,dt)}),o(ot),m(at,ot)};H(S,at=>{t.componentType?.configSchema&&at(w)})}o(W),o(L);var T=v(L,2),k=c(T);k.__click=[Cc,i];var D=v(k,2),R=c(D);R.__click=y;var V=v(R,2);V.__click=[Sc,f,t,n,r],o(D),o(T),o(b),o(M),ne(M,at=>p(s,at),()=>a(s));var tt=v(M,2);{var nt=at=>{var ot=Lc();ot.__keydown=[Ic,g];var I=c(ot);I.__click=[Fc];var Y=v(c(I),2),lt=c(Y);o(Y);var Q=v(Y,4),et=c(Q);et.__click=g;var ct=v(et,2);ct.__click=[Ec,t,i],o(Q),o(I),o(ot),j(()=>O(lt,`Are you sure you want to delete "${t.node.name??""}"?`)),m(at,ot)};H(tt,at=>{a(i)&&at(nt)})}j(()=>{O(G,`Edit: ${t.node.name??""}`),O(u,`Type: ${t.node.type??""}`),V.disabled=!a(f)}),ge("submit",W,at=>at.preventDefault()),Se(F,()=>a(n),at=>p(n,at)),m(q,N)};H(z,q=>{t.isOpen&&t.node&&q(B)})}m(e,E),Pt()}Bt(["click","keydown"]);var Bc=C('<span class="state-icon svelte-1piydef" role="img" aria-label="Running">â–¶ï¸</span>'),jc=C('<span class="state-icon svelte-1piydef" role="img" aria-label="Stopped">â¹ï¸</span>'),Xc=C('<span class="state-icon svelte-1piydef" role="img" aria-label="Error">ðŸ”´</span>'),Uc=C('<div class="error-section svelte-1piydef" role="alert"><span class="error-icon svelte-1piydef">âš </span> <span class="error-message svelte-1piydef"> </span></div>'),Yc=C('<div class="status-message svelte-1piydef" role="status">Cannot edit running flow</div>'),Wc=(e,t)=>t.onDeploy?.(),Kc=C('<button class="deploy-button svelte-1piydef" aria-label="Deploy flow">Deploy</button>'),Gc=(e,t)=>t.onStart?.(),Jc=C('<button class="start-button svelte-1piydef" aria-label="Start flow">Start</button>'),Zc=(e,t)=>t.onStop?.(),Qc=C('<button class="stop-button svelte-1piydef" aria-label="Stop flow">Stop</button>'),$c=(e,t)=>t.onToggleRuntimePanel?.(),tu=C('<button class="debug-button svelte-1piydef" aria-label="Toggle runtime panel" title="Toggle runtime panel (Ctrl+`)" data-testid="debug-toggle-button"> </button>'),eu=C('<div class="status-bar svelte-1piydef" data-testid="status-bar"><div class="status-section svelte-1piydef"><span class="status-label svelte-1piydef">Runtime:</span> <span aria-live="polite" aria-atomic="true"><!> </span></div> <!> <!> <div class="button-section svelte-1piydef"><!> <!> <!> <!></div></div>');function nu(e,t){qt(t,!0);let n=It(t,"showRuntimePanel",3,!1);const r=rt(()=>t.runtimeState.state==="not_deployed"),i=rt(()=>t.runtimeState.state==="deployed_stopped"),s=rt(()=>t.runtimeState.state==="running"),l=rt(()=>t.runtimeState.state==="running"),d=rt(()=>!t.isFlowValid||t.runtimeState.state!=="not_deployed"),f=rt(()=>t.runtimeState.state!=="not_deployed"?"Flow must be in not_deployed state":t.isFlowValid?"Deploy this flow":"Fix validation errors before deploying");var _=eu(),h=c(_),g=v(c(h),2),y=c(g);{var E=x=>{var u=Bc();m(x,u)},z=x=>{var u=Et(),S=gt(u);{var w=k=>{var D=jc();m(k,D)},T=k=>{var D=Et(),R=gt(D);{var V=tt=>{var nt=Xc();m(tt,nt)};H(R,tt=>{t.runtimeState.state==="error"&&tt(V)},!0)}m(k,D)};H(S,k=>{t.runtimeState.state==="deployed_stopped"?k(w):k(T,!1)},!0)}m(x,u)};H(y,x=>{t.runtimeState.state==="running"?x(E):x(z,!1)})}var B=v(y);o(g),o(h);var q=v(h,2);{var N=x=>{var u=Uc(),S=v(c(u),2),w=c(S,!0);o(S),o(u),j(()=>O(w,t.runtimeState.message)),m(x,u)};H(q,x=>{t.runtimeState.state==="error"&&t.runtimeState.message&&x(N)})}var M=v(q,2);{var b=x=>{var u=Yc();m(x,u)};H(M,x=>{t.runtimeState.state==="running"&&x(b)})}var P=v(M,2),K=c(P);{var G=x=>{var u=Kc();u.__click=[Wc,t],j(()=>{u.disabled=a(d),U(u,"title",a(f))}),m(x,u)};H(K,x=>{a(r)&&x(G)})}var $=v(K,2);{var L=x=>{var u=Jc();u.__click=[Gc,t],j(()=>u.disabled=t.runtimeState.state!=="deployed_stopped"),m(x,u)};H($,x=>{a(i)&&x(L)})}var W=v($,2);{var X=x=>{var u=Qc();u.__click=[Zc,t],j(()=>u.disabled=t.runtimeState.state!=="running"),m(x,u)};H(W,x=>{a(s)&&x(X)})}var F=v(W,2);{var A=x=>{var u=tu();u.__click=[$c,t];var S=c(u);o(u),j(()=>O(S,`${n()?"â–¼":"â–²"} Debug`)),m(x,u)};H(F,x=>{a(l)&&x(A)})}o(P),o(_),j(()=>{Ht(g,1,`runtime-state ${t.runtimeState.state??""}`,"svelte-1piydef"),U(g,"data-state",t.runtimeState.state),O(B,` ${t.runtimeState.state??""}`)}),m(e,_),Pt()}Bt(["click"]);function au(e,t,n,r){p(t,[],!0),p(n,"all"),p(r,"all")}var ru=C("<option> </option>"),iu=C('<div class="connection-status error svelte-v3r1ht" data-testid="connection-error"><span class="status-icon svelte-v3r1ht">âš </span> <span> </span></div>'),su=C('<div class="connection-status connecting svelte-v3r1ht" data-testid="connection-connecting"><span class="status-icon svelte-v3r1ht">â‹¯</span> <span>Connecting to log stream...</span></div>'),ou=C('<p class="svelte-v3r1ht">No logs yet. Waiting for runtime events...</p>'),lu=C('<p class="svelte-v3r1ht">No logs match current filters.</p>'),cu=C('<div class="empty-state svelte-v3r1ht"><!></div>'),uu=C('<div class="log-entry svelte-v3r1ht" data-testid="log-entry"><span class="log-timestamp svelte-v3r1ht"> </span> <span class="log-level svelte-v3r1ht"> </span> <span class="log-component svelte-v3r1ht"> </span> <span class="log-message svelte-v3r1ht"> </span></div>'),du=C('<div class="log-entries svelte-v3r1ht" role="log" aria-live="polite" aria-atomic="false"></div>'),vu=C('<div class="logs-tab svelte-v3r1ht" data-testid="logs-tab"><div class="filter-bar svelte-v3r1ht"><div class="filter-controls svelte-v3r1ht"><label for="level-filter" class="svelte-v3r1ht"><span class="filter-label svelte-v3r1ht">Level:</span> <select id="level-filter" data-testid="level-filter" class="svelte-v3r1ht"><option>All Levels</option><option>DEBUG</option><option>INFO</option><option>WARN</option><option>ERROR</option></select></label> <label for="component-filter" class="svelte-v3r1ht"><span class="filter-label svelte-v3r1ht">Component:</span> <select id="component-filter" data-testid="component-filter" class="svelte-v3r1ht"><option>All Components</option><!></select></label> <button class="clear-button svelte-v3r1ht" data-testid="clear-logs-button" aria-label="Clear all logs">Clear</button></div> <div class="auto-scroll-control svelte-v3r1ht"><label for="auto-scroll" class="svelte-v3r1ht"><input type="checkbox" id="auto-scroll" data-testid="auto-scroll-toggle" class="svelte-v3r1ht"/> <span>Auto-scroll</span></label></div></div> <!> <div class="log-container svelte-v3r1ht" data-testid="log-container"><!></div></div>');function fu(e,t){qt(t,!0);let n=st(Gt([])),r=st("all"),i=st("all"),s=st(!0),l=st("disconnected"),d=st(null),f=null;const _=rt(()=>Array.from(new Set(a(n).map(I=>I.component))).sort()),h=rt(()=>a(n).filter(I=>{const Y=a(r)==="all"||I.level===a(r),lt=a(i)==="all"||I.component===a(i);return Y&&lt}));let g=null;function y(I){p(n,[...a(n),I].slice(-1e3),!0),a(s)&&f&&requestAnimationFrame(()=>{f&&(f.scrollTop=f.scrollHeight)})}function E(I){try{const Y=new Date(I),lt=Y.getHours().toString().padStart(2,"0"),Q=Y.getMinutes().toString().padStart(2,"0"),et=Y.getSeconds().toString().padStart(2,"0"),ct=Y.getMilliseconds().toString().padStart(3,"0");return`${lt}:${Q}:${et}.${ct}`}catch{return I}}function z(I){return{DEBUG:"var(--ui-text-secondary)",INFO:"var(--status-info)",WARN:"var(--status-warning)",ERROR:"var(--status-error)"}[I]}function B(){if(!(!t.isActive||g)){p(l,"connecting"),p(d,null);try{const I=`/flowbuilder/flows/${t.flowId}/runtime/logs`;g=new EventSource(I),g.addEventListener("open",()=>{p(l,"connected"),console.log("[LogsTab] SSE connection established")}),g.addEventListener("log",Y=>{try{const lt=JSON.parse(Y.data);y(lt)}catch(lt){console.error("[LogsTab] Failed to parse log entry:",lt)}}),g.addEventListener("error",Y=>{console.warn("[LogsTab] SSE connection error:",Y),p(l,"error"),p(d,"Log streaming unavailable - backend endpoint not ready"),g&&(g.close(),g=null)})}catch(I){console.error("[LogsTab] Failed to create SSE connection:",I),p(l,"error"),p(d,"Failed to connect to log stream")}}}function q(){g&&(g.close(),g=null,p(l,"disconnected"),console.log("[LogsTab] SSE connection closed"))}Xt(()=>(t.isActive?B():q(),()=>{q()})),Xt(()=>{a(h),a(s)&&f&&requestAnimationFrame(()=>{f&&(f.scrollTop=f.scrollHeight)})});var N=vu(),M=c(N),b=c(M),P=c(b),K=v(c(P),2),G=c(K);G.value=G.__value="all";var $=v(G);$.value=$.__value="DEBUG";var L=v($);L.value=L.__value="INFO";var W=v(L);W.value=W.__value="WARN";var X=v(W);X.value=X.__value="ERROR",o(K),o(P);var F=v(P,2),A=v(c(F),2),x=c(A);x.value=x.__value="all";var u=v(x);Ct(u,16,()=>a(_),I=>I,(I,Y)=>{var lt=ru(),Q=c(lt,!0);o(lt);var et={};j(()=>{O(Q,Y),et!==(et=Y)&&(lt.value=(lt.__value=Y)??"")}),m(I,lt)}),o(A),o(F);var S=v(F,2);S.__click=[au,n,r,i],o(b);var w=v(b,2),T=c(w),k=c(T);re(k),Hn(2),o(T),o(w),o(M);var D=v(M,2);{var R=I=>{var Y=iu(),lt=v(c(Y),2),Q=c(lt,!0);o(lt),o(Y),j(()=>O(Q,a(d)||"Log streaming unavailable")),m(I,Y)},V=I=>{var Y=Et(),lt=gt(Y);{var Q=et=>{var ct=su();m(et,ct)};H(lt,et=>{a(l)==="connecting"&&et(Q)},!0)}m(I,Y)};H(D,I=>{a(l)==="error"?I(R):I(V,!1)})}var tt=v(D,2),nt=c(tt);{var at=I=>{var Y=cu(),lt=c(Y);{var Q=ct=>{var mt=ou();m(ct,mt)},et=ct=>{var mt=lu();m(ct,mt)};H(lt,ct=>{a(n).length===0?ct(Q):ct(et,!1)})}o(Y),m(I,Y)},ot=I=>{var Y=du();Ct(Y,21,()=>a(h),lt=>lt.timestamp+lt.component+lt.message,(lt,Q)=>{var et=uu(),ct=c(et),mt=c(ct,!0);o(ct);var Z=v(ct,2),dt=c(Z,!0);o(Z);var ht=v(Z,2),_t=c(ht);o(ht);var xt=v(ht,2),Tt=c(xt,!0);o(xt),o(et),j((Dt,jt)=>{U(et,"data-level",a(Q).level),O(mt,Dt),me(Z,`color: ${jt??""}`),O(dt,a(Q).level),O(_t,`[${a(Q).component??""}]`),O(Tt,a(Q).message)},[()=>E(a(Q).timestamp),()=>z(a(Q).level)]),m(lt,et)}),o(Y),m(I,Y)};H(nt,I=>{a(h).length===0?I(at):I(ot,!1)})}o(tt),ne(tt,I=>f=I,()=>f),o(N),Me(K,()=>a(r),I=>p(r,I)),Me(A,()=>a(i),I=>p(i,I)),pn(k,()=>a(s),I=>p(s,I)),m(e,N),Pt()}Bt(["click"]);function hu(e,t,n,r,i){p(t,[],!0),p(n,"all"),p(r,"all"),i.clear()}function _u(e,t){t()}var gu=C("<option> </option>"),mu=C('<button class="refresh-button svelte-7dk3q0" data-testid="manual-refresh-button" aria-label="Refresh messages now">Refresh</button>'),pu=C('<div class="error-message svelte-7dk3q0" role="alert"><span class="error-icon svelte-7dk3q0">âš </span> <span> </span></div>'),yu=C('<p class="svelte-7dk3q0">No messages yet. Waiting for NATS traffic...</p>'),bu=C('<p class="svelte-7dk3q0">No messages match current filters.</p>'),wu=C('<div class="empty-state svelte-7dk3q0"><!></div>'),xu=(e,t,n)=>t(a(n).message_id),ku=C('<button class="metadata-toggle svelte-7dk3q0" aria-label="Toggle metadata"> </button>'),Su=C('<div class="metadata svelte-7dk3q0"><pre class="svelte-7dk3q0"> </pre></div>'),Cu=C('<div class="message-entry svelte-7dk3q0" data-testid="message-entry"><span class="timestamp svelte-7dk3q0"> </span> <span> </span> <span class="component svelte-7dk3q0"> </span> <span class="subject svelte-7dk3q0"> </span> <span class="summary svelte-7dk3q0"> </span> <!></div> <!>',1),Eu=C('<div class="message-entries svelte-7dk3q0" role="log" aria-live="polite" aria-atomic="false"></div>'),Tu=C('<div class="messages-tab svelte-7dk3q0" data-testid="messages-tab"><div class="control-bar svelte-7dk3q0"><div class="filter-controls svelte-7dk3q0"><label for="component-filter" class="svelte-7dk3q0"><span class="filter-label svelte-7dk3q0">Component:</span> <select id="component-filter" data-testid="component-filter" aria-label="Filter by component" class="svelte-7dk3q0"><option>All Components</option><!></select></label> <label for="direction-filter" class="svelte-7dk3q0"><span class="filter-label svelte-7dk3q0">Direction:</span> <select id="direction-filter" data-testid="direction-filter" aria-label="Filter by direction" class="svelte-7dk3q0"><option>All</option><option>Published</option><option>Received</option><option>Processed</option></select></label> <label for="poll-rate" class="svelte-7dk3q0"><span class="filter-label svelte-7dk3q0">Poll:</span> <select id="poll-rate" data-testid="poll-rate-selector" aria-label="Poll rate" class="svelte-7dk3q0"><option>Every 1s</option><option>Every 2s</option><option>Every 5s</option><option>Manual</option></select></label> <!> <button class="clear-button svelte-7dk3q0" data-testid="clear-messages-button" aria-label="Clear all messages">Clear</button></div> <div class="auto-scroll-control svelte-7dk3q0"><label for="auto-scroll" class="svelte-7dk3q0"><input type="checkbox" id="auto-scroll" data-testid="auto-scroll-toggle" class="svelte-7dk3q0"/> <span>Auto-scroll</span></label></div></div> <!> <div class="messages-container svelte-7dk3q0" data-testid="messages-container"><!></div></div>');function Nu(e,t){qt(t,!0);let n=st(Gt([])),r=st("all"),i=st("all"),s=st(!0),l=st(2e3),d=new Ke,f=st(null),_=null;const h=500,g=rt(()=>Array.from(new Set(a(n).map(Z=>Z.component))).sort()),y=rt(()=>a(n).filter(Z=>{const dt=a(r)==="all"||Z.component===a(r),ht=a(i)==="all"||Z.direction===a(i);return dt&&ht}));function E(Z){try{const dt=new Date(Z),ht=dt.getHours().toString().padStart(2,"0"),_t=dt.getMinutes().toString().padStart(2,"0"),xt=dt.getSeconds().toString().padStart(2,"0"),Tt=dt.getMilliseconds().toString().padStart(3,"0");return`${ht}:${_t}:${xt}.${Tt}`}catch{return Z}}function z(Z){return{published:"â†’",received:"â†",processed:"âŸ³"}[Z]}function B(Z){return{published:"var(--status-info)",received:"var(--status-success)",processed:"var(--ui-text-secondary)"}[Z]}function q(Z){d.has(Z)?d.delete(Z):d.add(Z)}async function N(){try{const Z=await fetch(`/flowbuilder/flows/${t.flowId}/runtime/messages`);if(!Z.ok)throw new Error(`HTTP ${Z.status}: ${Z.statusText}`);const dt=await Z.json(),ht=new Set(a(n).map(xt=>xt.message_id)),_t=dt.messages.filter(xt=>!ht.has(xt.message_id));p(n,[...a(n),..._t].slice(-h),!0),p(f,null),a(s)&&_&&requestAnimationFrame(()=>{_&&(_.scrollTop=_.scrollHeight)})}catch(Z){p(f,"Messages unavailable - backend endpoint not ready"),console.warn("[MessagesTab] Messages fetch failed:",Z)}}Xt(()=>{if(!t.isActive||a(l)==="manual")return;N();const Z=setInterval(N,a(l));return()=>{clearInterval(Z)}}),Xt(()=>{a(y),a(s)&&_&&requestAnimationFrame(()=>{_&&(_.scrollTop=_.scrollHeight)})});var M=Tu(),b=c(M),P=c(b),K=c(P),G=v(c(K),2),$=c(G);$.value=$.__value="all";var L=v($);Ct(L,16,()=>a(g),Z=>Z,(Z,dt)=>{var ht=gu(),_t=c(ht,!0);o(ht);var xt={};j(()=>{O(_t,dt),xt!==(xt=dt)&&(ht.value=(ht.__value=dt)??"")}),m(Z,ht)}),o(G),o(K);var W=v(K,2),X=v(c(W),2),F=c(X);F.value=F.__value="all";var A=v(F);A.value=A.__value="published";var x=v(A);x.value=x.__value="received";var u=v(x);u.value=u.__value="processed",o(X),o(W);var S=v(W,2),w=v(c(S),2),T=c(w);T.value=T.__value=1e3;var k=v(T);k.value=k.__value=2e3;var D=v(k);D.value=D.__value=5e3;var R=v(D);R.value=R.__value="manual",o(w),o(S);var V=v(S,2);{var tt=Z=>{var dt=mu();dt.__click=[_u,N],m(Z,dt)};H(V,Z=>{a(l)==="manual"&&Z(tt)})}var nt=v(V,2);nt.__click=[hu,n,r,i,d],o(P);var at=v(P,2),ot=c(at),I=c(ot);re(I),Hn(2),o(ot),o(at),o(b);var Y=v(b,2);{var lt=Z=>{var dt=pu(),ht=v(c(dt),2),_t=c(ht,!0);o(ht),o(dt),j(()=>O(_t,a(f))),m(Z,dt)};H(Y,Z=>{a(f)&&Z(lt)})}var Q=v(Y,2),et=c(Q);{var ct=Z=>{var dt=wu(),ht=c(dt);{var _t=Tt=>{var Dt=yu();m(Tt,Dt)},xt=Tt=>{var Dt=bu();m(Tt,Dt)};H(ht,Tt=>{a(n).length===0?Tt(_t):Tt(xt,!1)})}o(dt),m(Z,dt)},mt=Z=>{var dt=Eu();Ct(dt,21,()=>a(y),ht=>ht.message_id,(ht,_t)=>{var xt=Cu(),Tt=gt(xt),Dt=c(Tt),jt=c(Dt,!0);o(Dt);var Ft=v(Dt,2);let Yt;var Lt=c(Ft,!0);o(Ft);var Mt=v(Ft,2),ft=c(Mt);o(Mt);var it=v(Mt,2),vt=c(it,!0);o(it);var pt=v(it,2),Rt=c(pt,!0);o(pt);var Ot=v(pt,2);{var wt=St=>{var bt=ku();bt.__click=[xu,q,_t];var zt=c(bt,!0);o(bt),j((Vt,Kt)=>{U(bt,"aria-expanded",Vt),O(zt,Kt)},[()=>d.has(a(_t).message_id),()=>d.has(a(_t).message_id)?"â–¼":"â–¶"]),m(St,bt)};H(Ot,St=>{a(_t).metadata&&St(wt)})}o(Tt);var Nt=v(Tt,2);{var At=St=>{var bt=Su(),zt=c(bt),Vt=c(zt,!0);o(zt),o(bt),j(Kt=>O(Vt,Kt),[()=>JSON.stringify(a(_t).metadata,null,2)]),m(St,bt)};H(Nt,St=>{d.has(a(_t).message_id)&&a(_t).metadata&&St(At)})}j((St,bt,zt,Vt)=>{O(jt,St),Yt=Ht(Ft,1,"direction svelte-7dk3q0",null,Yt,bt),me(Ft,`color: ${zt??""}`),U(Ft,"aria-label",a(_t).direction),O(Lt,Vt),O(ft,`[${a(_t).component??""}]`),O(vt,a(_t).subject),O(Rt,a(_t).summary)},[()=>E(a(_t).timestamp),()=>({published:a(_t).direction==="published",received:a(_t).direction==="received",processed:a(_t).direction==="processed"}),()=>B(a(_t).direction),()=>z(a(_t).direction)]),m(ht,xt)}),o(dt),m(Z,dt)};H(et,Z=>{a(y).length===0?Z(ct):Z(mt,!1)})}o(Q),ne(Q,Z=>_=Z,()=>_),o(M),Me(G,()=>a(r),Z=>p(r,Z)),Me(X,()=>a(i),Z=>p(i,Z)),Me(w,()=>a(l),Z=>p(l,Z)),pn(I,()=>a(s),Z=>p(s,Z)),m(e,M),Pt()}Bt(["click"]);function Au(e,t){t()}var Mu=C('<button class="refresh-button svelte-1wgk637" data-testid="manual-refresh-button" aria-label="Refresh metrics now">Refresh</button>'),zu=C('<div class="last-updated svelte-1wgk637" data-testid="last-updated"> </div>'),Du=C('<div class="error-message svelte-1wgk637" role="alert"><span class="error-icon svelte-1wgk637">âš </span> <span> </span></div>'),Ru=C('<div class="empty-state svelte-1wgk637"><p class="svelte-1wgk637">No metrics available</p></div>'),qu=C('<tr data-testid="metrics-row" class="svelte-1wgk637"><td class="component-name svelte-1wgk637"> </td><td class="metric-value svelte-1wgk637"> </td><td> </td><td class="metric-value svelte-1wgk637"> </td><td class="metric-value svelte-1wgk637"> </td><td class="status-cell svelte-1wgk637"><span class="status-indicator svelte-1wgk637" data-testid="status-indicator">â—</span></td></tr>'),Pu=C('<table aria-label="Component metrics" class="svelte-1wgk637"><thead class="svelte-1wgk637"><tr><th scope="col" class="svelte-1wgk637">Component</th><th scope="col" class="svelte-1wgk637">Msg/sec</th><th scope="col" class="svelte-1wgk637">Errors/sec</th><th scope="col" class="svelte-1wgk637">CPU</th><th scope="col" class="svelte-1wgk637">Memory</th><th scope="col" class="svelte-1wgk637">Status</th></tr></thead><tbody class="svelte-1wgk637"></tbody></table>'),Ou=C('<div class="metrics-tab svelte-1wgk637" data-testid="metrics-tab"><div class="control-bar svelte-1wgk637"><div class="refresh-control svelte-1wgk637"><label for="refresh-rate" class="svelte-1wgk637"><span class="control-label svelte-1wgk637">Refresh:</span> <select id="refresh-rate" data-testid="refresh-rate-selector" aria-label="Refresh rate" class="svelte-1wgk637"><option>Every 1s</option><option>Every 2s</option><option>Every 5s</option><option>Every 10s</option><option>Manual</option></select></label> <!></div> <!></div> <!> <div class="table-container svelte-1wgk637"><!></div></div>');function Iu(e,t){qt(t,!0);let n=st(2e3),r=st(null),i=st(null),s=st(null);const l=rt(()=>a(r)?.components.slice().sort((k,D)=>k.name.localeCompare(D.name))||[]);function d(k){return k.toLocaleString("en-US")}function f(k){return`${(k/1048576).toFixed(2)} MB`}function _(k){return`${k.toFixed(1)}%`}function h(k){return k.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})}function g(k){return{healthy:"var(--status-success)",degraded:"var(--status-warning)",error:"var(--status-error)"}[k]}function y(k){return{healthy:"Healthy - No errors",degraded:"Degraded - Some errors detected",error:"Error - High error rate"}[k]}async function E(){try{const k=await fetch(`/flowbuilder/flows/${t.flowId}/runtime/metrics`);if(!k.ok)throw new Error(`HTTP ${k.status}: ${k.statusText}`);const D=await k.json();p(r,D,!0),p(i,new Date,!0),p(s,null)}catch(k){p(s,"Metrics unavailable - backend endpoint not ready"),console.warn("[MetricsTab] Metrics fetch failed:",k)}}Xt(()=>{if(!t.isActive||a(n)==="manual")return;E();const k=setInterval(E,a(n));return()=>{clearInterval(k)}});var z=Ou(),B=c(z),q=c(B),N=c(q),M=v(c(N),2),b=c(M);b.value=b.__value=1e3;var P=v(b);P.value=P.__value=2e3;var K=v(P);K.value=K.__value=5e3;var G=v(K);G.value=G.__value=1e4;var $=v(G);$.value=$.__value="manual",o(M),o(N);var L=v(N,2);{var W=k=>{var D=Mu();D.__click=[Au,E],m(k,D)};H(L,k=>{a(n)==="manual"&&k(W)})}o(q);var X=v(q,2);{var F=k=>{var D=zu(),R=c(D);o(D),j(V=>O(R,`Last: ${V??""}`),[()=>h(a(i))]),m(k,D)};H(X,k=>{a(i)&&k(F)})}o(B);var A=v(B,2);{var x=k=>{var D=Du(),R=v(c(D),2),V=c(R,!0);o(R),o(D),j(()=>O(V,a(s))),m(k,D)};H(A,k=>{a(s)&&k(x)})}var u=v(A,2),S=c(u);{var w=k=>{var D=Ru();m(k,D)},T=k=>{var D=Et(),R=gt(D);{var V=tt=>{var nt=Pu(),at=v(c(nt));Ct(at,21,()=>a(l),ot=>ot.name,(ot,I)=>{var Y=qu(),lt=c(Y),Q=c(lt,!0);o(lt);var et=v(lt),ct=c(et,!0);o(et);var mt=v(et);let Z;var dt=c(mt,!0);o(mt);var ht=v(mt),_t=c(ht,!0);o(ht);var xt=v(ht),Tt=c(xt,!0);o(xt);var Dt=v(xt),jt=c(Dt);o(Dt),o(Y),j((Ft,Yt,Lt,Mt,ft,it,vt)=>{O(Q,a(I).name),O(ct,Ft),Z=Ht(mt,1,"metric-value svelte-1wgk637",null,Z,Yt),O(dt,Lt),O(_t,Mt),O(Tt,ft),me(jt,`color: ${it??""}`),U(jt,"aria-label",vt)},[()=>d(a(I).throughput),()=>({"has-errors":a(I).errorRate>0}),()=>d(a(I).errorRate),()=>a(I).cpu!==void 0?_(a(I).cpu):"N/A",()=>a(I).memory!==void 0?f(a(I).memory):"N/A",()=>g(a(I).status),()=>y(a(I).status)]),m(ot,Y)}),o(at),o(nt),m(tt,nt)};H(R,tt=>{a(l).length>0&&tt(V)},!0)}m(k,D)};H(S,k=>{a(l).length===0&&!a(s)?k(w):k(T,!1)})}o(u),o(z),Me(M,()=>a(n),k=>p(n,k)),m(e,z),Pt()}Bt(["click"]);var Fu=C('<div class="error-message svelte-1fy36ri" role="alert" data-testid="health-error"><span class="error-icon svelte-1fy36ri">âš </span> <span> </span></div>'),Lu=C('<div class="health-summary svelte-1fy36ri" data-testid="health-summary"><span class="overall-status svelte-1fy36ri"><span class="status-icon svelte-1fy36ri"> </span> <span class="status-text svelte-1fy36ri">System Health:</span> <span class="health-count svelte-1fy36ri"> </span></span></div>'),Vu=C('<div class="empty-state svelte-1fy36ri"><p class="svelte-1fy36ri">No health data available</p></div>'),Hu=(e,t,n)=>t(a(n).name),Bu=C('<button class="expand-button svelte-1fy36ri" data-testid="expand-button"> </button>'),ju=C('<tr class="details-row svelte-1fy36ri" data-testid="details-row"><td colspan="4" class="svelte-1fy36ri"><div class="details-content svelte-1fy36ri"><div><span class="severity-label svelte-1fy36ri"> </span> <span class="severity-message svelte-1fy36ri"> </span></div> <div class="detail-timestamp svelte-1fy36ri"> </div></div></td></tr>'),Xu=C('<tr data-testid="health-row"><td class="component-name svelte-1fy36ri"><!> <span class="name-text svelte-1fy36ri"> </span></td><td class="status-cell svelte-1fy36ri"><span class="status-indicator svelte-1fy36ri" data-testid="status-indicator"> </span> <span class="status-label svelte-1fy36ri"> </span></td><td class="uptime-cell svelte-1fy36ri"><span class="uptime-value svelte-1fy36ri"> </span></td><td><span class="activity-value svelte-1fy36ri"> </span></td></tr> <!>',1),Uu=C('<table aria-label="Component health status" class="svelte-1fy36ri"><thead class="svelte-1fy36ri"><tr><th scope="col" class="col-component svelte-1fy36ri">Component</th><th scope="col" class="col-status svelte-1fy36ri">Status</th><th scope="col" class="col-uptime svelte-1fy36ri">Uptime</th><th scope="col" class="col-activity svelte-1fy36ri">Last Activity</th></tr></thead><tbody class="svelte-1fy36ri"></tbody></table>'),Yu=C('<div class="health-tab svelte-1fy36ri" data-testid="health-tab"><!> <!> <div class="table-container svelte-1fy36ri"><!></div></div>');function Wu(e,t){qt(t,!0);let n=st(null),r=st(Gt(new Date)),i=new Ke,s=st(null);const l=rt(()=>a(n)?.components.slice().sort((A,x)=>A.name.localeCompare(x.name))||[]),d=rt(()=>A=>i.has(A));function f(A,x){const u=new Date(A),S=Math.floor((x.getTime()-u.getTime())/1e3),w=Math.floor(S/3600),T=Math.floor(S%3600/60),k=S%60;return`${w.toString().padStart(2,"0")}:${T.toString().padStart(2,"0")}:${k.toString().padStart(2,"0")}`}function _(A,x){const u=new Date(A),S=Math.floor((x.getTime()-u.getTime())/1e3);if(S<60)return`${S} ${S===1?"second":"seconds"} ago`;if(S<3600){const T=Math.floor(S/60);return`${T} ${T===1?"minute":"minutes"} ago`}if(S<86400){const T=Math.floor(S/3600);return`${T} ${T===1?"hour":"hours"} ago`}const w=Math.floor(S/86400);return`${w} ${w===1?"day":"days"} ago`}function h(A,x){const u=new Date(A);return Math.floor((x.getTime()-u.getTime())/1e3)>30}function g(A){return{running:"var(--status-success)",degraded:"var(--status-warning)",error:"var(--status-error)"}[A]}function y(A){return{running:"â—",degraded:"âš ",error:"â—"}[A]}function E(A){return{running:"Running - Component is healthy",degraded:"Degraded - Component has warnings",error:"Error - Component has critical issues"}[A]}function z(A){return{healthy:"var(--status-success)",degraded:"var(--status-warning)",error:"var(--status-error)"}[A]}function B(A){return{healthy:"ðŸŸ¢",degraded:"ðŸŸ¡",error:"ðŸ”´"}[A]}function q(A){i.has(A)?i.delete(A):i.add(A)}function N(A){try{return new Date(A).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch{return A}}async function M(){try{const A=await fetch(`/flowbuilder/flows/${t.flowId}/runtime/health`);if(!A.ok)throw new Error(`HTTP ${A.status}: ${A.statusText}`);const x=await A.json();p(n,x,!0),p(s,null)}catch(A){p(s,"Health monitoring unavailable - backend endpoint not ready"),console.warn("[HealthTab] Health fetch failed:",A)}}Xt(()=>{if(!t.isActive)return;M();const A=setInterval(M,5e3);return()=>{clearInterval(A)}}),Xt(()=>{if(!t.isActive)return;const A=setInterval(()=>{p(r,new Date,!0)},1e3);return()=>{clearInterval(A)}});var b=Yu(),P=c(b);{var K=A=>{var x=Fu(),u=v(c(x),2),S=c(u,!0);o(u),o(x),j(()=>O(S,a(s))),m(A,x)};H(P,A=>{a(s)&&A(K)})}var G=v(P,2);{var $=A=>{var x=Lu(),u=c(x),S=c(u),w=c(S,!0);o(S);var T=v(S,4),k=c(T);o(T),o(u),o(x),j((D,R)=>{me(u,`color: ${D??""}`),U(u,"aria-label",`Overall system health: ${a(n).overall.status??""}`),O(w,R),O(k,`${a(n).overall.healthyCount??""}/${a(n).overall.totalCount??""} components healthy`)},[()=>z(a(n).overall.status),()=>B(a(n).overall.status)]),m(A,x)};H(G,A=>{a(n)?.overall&&A($)})}var L=v(G,2),W=c(L);{var X=A=>{var x=Vu();m(A,x)},F=A=>{var x=Et(),u=gt(x);{var S=w=>{var T=Uu(),k=v(c(T));Ct(k,21,()=>a(l),D=>D.name,(D,R)=>{var V=Xu(),tt=gt(V);let nt;var at=c(tt),ot=c(at);{var I=Lt=>{var Mt=Bu();Mt.__click=[Hu,q,R];var ft=c(Mt,!0);o(Mt),j((it,vt,pt)=>{U(Mt,"aria-expanded",it),U(Mt,"aria-label",vt),O(ft,pt)},[()=>a(d)(a(R).name),()=>a(d)(a(R).name)?`Collapse details for ${a(R).name}`:`Expand details for ${a(R).name}`,()=>a(d)(a(R).name)?"â–¼":"â–¶"]),m(Lt,Mt)};H(ot,Lt=>{a(R).details&&Lt(I)})}var Y=v(ot,2),lt=c(Y,!0);o(Y),o(at);var Q=v(at),et=c(Q),ct=c(et,!0);o(et);var mt=v(et,2),Z=c(mt,!0);o(mt),o(Q);var dt=v(Q),ht=c(dt),_t=c(ht,!0);o(ht),o(dt);var xt=v(dt);let Tt;var Dt=c(xt),jt=c(Dt,!0);o(Dt),o(xt),o(tt);var Ft=v(tt,2);{var Yt=Lt=>{var Mt=ju(),ft=c(Mt),it=c(ft),vt=c(it);let pt;var Rt=c(vt),Ot=c(Rt);o(Rt);var wt=v(Rt,2),Nt=c(wt,!0);o(wt),o(vt);var At=v(vt,2),St=c(At);o(At),o(it),o(ft),o(Mt),j((bt,zt,Vt)=>{pt=Ht(vt,1,"detail-severity svelte-1fy36ri",null,pt,bt),O(Ot,`${zt??""}:`),O(Nt,a(R).details.message),O(St,`Occurred: ${Vt??""}`)},[()=>({"is-error":a(R).details.severity==="error"}),()=>a(R).details.severity.toUpperCase(),()=>N(a(R).details.timestamp)]),m(Lt,Mt)};H(Ft,Lt=>{a(R).details&&a(d)(a(R).name)&&Lt(Yt)})}j((Lt,Mt,ft,it,vt,pt,Rt)=>{nt=Ht(tt,1,"svelte-1fy36ri",null,nt,Lt),O(lt,a(R).name),me(et,`color: ${Mt??""}`),U(et,"aria-label",ft),O(ct,it),O(Z,a(R).status),O(_t,vt),Tt=Ht(xt,1,"activity-cell svelte-1fy36ri",null,Tt,pt),O(jt,Rt)},[()=>({"has-details":a(R).details!==null}),()=>g(a(R).status),()=>E(a(R).status),()=>y(a(R).status),()=>f(a(R).startTime,a(r)),()=>({stale:h(a(R).lastActivity,a(r))}),()=>_(a(R).lastActivity,a(r))]),m(D,V)}),o(k),o(T),m(w,T)};H(u,w=>{a(l).length>0&&w(S)},!0)}m(A,x)};H(W,A=>{a(l).length===0&&!a(s)?A(X):A(F,!1)})}o(L),o(b),m(e,b),Pt()}Bt(["click"]);var Ku=(e,t)=>t("logs"),Gu=(e,t)=>t("messages"),Ju=(e,t)=>t("metrics"),Zu=(e,t)=>t("health"),Qu=C('<div id="logs-panel" role="tabpanel" aria-labelledby="tab-logs" class="tab-content svelte-1v0suwy" data-testid="logs-panel"><!></div>'),$u=C('<div id="messages-panel" role="tabpanel" aria-labelledby="tab-messages" class="tab-content svelte-1v0suwy" data-testid="messages-panel"><!></div>'),td=C('<div id="metrics-panel" role="tabpanel" aria-labelledby="tab-metrics" class="tab-content svelte-1v0suwy" data-testid="metrics-panel"><!></div>'),ed=C('<div id="health-panel" role="tabpanel" aria-labelledby="tab-health" class="tab-content svelte-1v0suwy" data-testid="health-panel"><!></div>'),nd=C('<div class="runtime-panel svelte-1v0suwy" data-testid="runtime-panel"><header class="svelte-1v0suwy"><div class="header-content svelte-1v0suwy"><h3 class="svelte-1v0suwy">Runtime Debugging</h3> <div class="tab-nav svelte-1v0suwy" role="tablist" aria-label="Runtime debugging tabs"><button role="tab" id="tab-logs" aria-controls="logs-panel" data-testid="tab-logs">Logs</button> <button role="tab" id="tab-messages" aria-controls="messages-panel" data-testid="tab-messages">Messages</button> <button role="tab" id="tab-metrics" aria-controls="metrics-panel" data-testid="tab-metrics">Metrics</button> <button role="tab" id="tab-health" aria-controls="health-panel" data-testid="tab-health">Health</button></div></div> <button class="close-button svelte-1v0suwy" aria-label="Close runtime panel">âœ•</button></header> <div class="panel-body svelte-1v0suwy"><!></div></div>');function ad(e,t){qt(t,!0);let n=It(t,"isOpen",3,!1),r=It(t,"height",3,300),i=st("logs");function s(h){h.key==="Escape"&&n()&&(h.preventDefault(),t.onClose?.())}function l(h){p(i,h,!0)}var d=Et();ge("keydown",Pe,s);var f=gt(d);{var _=h=>{var g=nd(),y=c(g),E=c(y),z=v(c(E),2),B=c(z);let q;B.__click=[Ku,l];var N=v(B,2);let M;N.__click=[Gu,l];var b=v(N,2);let P;b.__click=[Ju,l];var K=v(b,2);let G;K.__click=[Zu,l],o(z),o(E);var $=v(E,2);$.__click=function(...A){t.onClose?.apply(this,A)},o(y);var L=v(y,2),W=c(L);{var X=A=>{var x=Qu(),u=c(x);{let S=rt(()=>a(i)==="logs");fu(u,{get flowId(){return t.flowId},get isActive(){return a(S)}})}o(x),m(A,x)},F=A=>{var x=Et(),u=gt(x);{var S=T=>{var k=$u(),D=c(k);{let R=rt(()=>a(i)==="messages");Nu(D,{get flowId(){return t.flowId},get isActive(){return a(R)}})}o(k),m(T,k)},w=T=>{var k=Et(),D=gt(k);{var R=tt=>{var nt=td(),at=c(nt);{let ot=rt(()=>a(i)==="metrics");Iu(at,{get flowId(){return t.flowId},get isActive(){return a(ot)}})}o(nt),m(tt,nt)},V=tt=>{var nt=Et(),at=gt(nt);{var ot=I=>{var Y=ed(),lt=c(Y);{let Q=rt(()=>a(i)==="health");Wu(lt,{get flowId(){return t.flowId},get isActive(){return a(Q)}})}o(Y),m(I,Y)};H(at,I=>{a(i)==="health"&&I(ot)},!0)}m(tt,nt)};H(D,tt=>{a(i)==="metrics"?tt(R):tt(V,!1)},!0)}m(T,k)};H(u,T=>{a(i)==="messages"?T(S):T(w,!1)},!0)}m(A,x)};H(W,A=>{a(i)==="logs"?A(X):A(F,!1)})}o(L),o(g),j((A,x,u,S)=>{me(g,`height: ${r()??""}px;`),U(B,"aria-selected",a(i)==="logs"),q=Ht(B,1,"tab-button svelte-1v0suwy",null,q,A),U(N,"aria-selected",a(i)==="messages"),M=Ht(N,1,"tab-button svelte-1v0suwy",null,M,x),U(b,"aria-selected",a(i)==="metrics"),P=Ht(b,1,"tab-button svelte-1v0suwy",null,P,u),U(K,"aria-selected",a(i)==="health"),G=Ht(K,1,"tab-button svelte-1v0suwy",null,G,S)},[()=>({active:a(i)==="logs"}),()=>({active:a(i)==="messages"}),()=>({active:a(i)==="metrics"}),()=>({active:a(i)==="health"})]),m(h,g)};H(f,h=>{n()&&h(_)})}m(e,d),Pt()}Bt(["click"]);var rd=C('<button type="button" data-testid="validation-status" aria-label="View validation details"><span class="status-icon svelte-djbjik"> </span> <span class="status-text svelte-djbjik"> </span></button>'),id=C('<span role="img"> </span> <span class="status-text svelte-djbjik"> </span>',1),sd=C('<span role="img"> </span> <span class="status-text svelte-djbjik"> </span>',1),od=C('<span role="img"> </span> <span class="status-text svelte-djbjik"> </span>',1),ld=C('<span role="img"> </span> <span class="status-text svelte-djbjik"> </span>',1),cd=C('<span class="timestamp svelte-djbjik"> </span>'),ud=C('<button type="button" class="save-button svelte-djbjik" aria-label="Save flow">Save</button>'),dd=C('<div class="error-message svelte-djbjik" role="alert"> </div>'),vd=C('<div id="save-status" class="save-status-indicator save-status svelte-djbjik"><div class="status-content svelte-djbjik"><!> <!> <!> <!></div> <!></div>');function fd(e,t){qt(t,!0);function n(M){return M?new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"2-digit",second:"2-digit"}).format(M):""}const r=rt(()=>{switch(t.saveState.status){case"clean":return{text:"Valid",icon:"âœ“",class:"status-clean"};case"draft":return{text:`Draft - ${t.saveState.error||"has errors"}`,icon:"âš ",class:"status-draft"};case"dirty":return{text:"Unsaved changes",icon:"â—",class:"status-dirty"};case"saving":return{text:"Saving...",icon:"âŸ³",class:"status-saving"};case"error":return{text:"Save failed",icon:"âš ",class:"status-error"}}}),i=rt(()=>{if(!t.validationResult)return{text:"Validating...",icon:"âŸ³",class:"validation-validating"};if(t.validationResult.errors.length>0){const M=t.validationResult.errors.length;return{text:`Draft - ${M} error${M>1?"s":""}`,icon:"âŒ",class:"validation-error"}}if(t.validationResult.warnings.length>0){const M=t.validationResult.warnings.length;return{text:`${M} warning${M>1?"s":""}`,icon:"âš ï¸",class:"validation-warning"}}return{text:"Valid",icon:"âœ“",class:"validation-valid"}});var s=vd(),l=c(s),d=c(l);{var f=M=>{var b=rd();b.__click=function(...L){t.onValidationClick?.apply(this,L)};var P=c(b),K=c(P,!0);o(P);var G=v(P,2),$=c(G,!0);o(G),o(b),j(()=>{Ht(b,1,`validation-status ${a(i).class??""}`,"svelte-djbjik"),O(K,a(i).icon),O($,a(i).text)}),m(M,b)};H(d,M=>{t.validationResult!==void 0&&M(f)})}var _=v(d,2);{var h=M=>{var b=id(),P=gt(b),K=c(P,!0);o(P);var G=v(P,2),$=c(G,!0);o(G),j(()=>{Ht(P,1,`status-icon ${a(r).class??""}`,"svelte-djbjik"),U(P,"aria-label",a(r).text),O(K,a(r).icon),O($,a(r).text)}),m(M,b)},g=M=>{var b=Et(),P=gt(b);{var K=$=>{var L=sd(),W=gt(L),X=c(W,!0);o(W);var F=v(W,2),A=c(F,!0);o(F),j(()=>{Ht(W,1,`status-icon ${a(r).class??""}`,"svelte-djbjik"),U(W,"aria-label",a(r).text),O(X,a(r).icon),O(A,a(r).text)}),m($,L)},G=$=>{var L=Et(),W=gt(L);{var X=A=>{var x=od(),u=gt(x),S=c(u,!0);o(u);var w=v(u,2),T=c(w,!0);o(w),j(()=>{Ht(u,1,`status-icon ${a(r).class??""}`,"svelte-djbjik"),U(u,"aria-label",a(r).text),O(S,a(r).icon),O(T,a(r).text)}),m(A,x)},F=A=>{var x=Et(),u=gt(x);{var S=w=>{var T=ld(),k=gt(T),D=c(k,!0);o(k);var R=v(k,2),V=c(R,!0);o(R),j(()=>{Ht(k,1,`status-icon ${a(r).class??""}`,"svelte-djbjik"),U(k,"aria-label",a(r).text),O(D,a(r).icon),O(V,a(r).text)}),m(w,T)};H(u,w=>{t.saveState.status==="error"&&w(S)},!0)}m(A,x)};H(W,A=>{t.saveState.status==="saving"?A(X):A(F,!1)},!0)}m($,L)};H(P,$=>{t.saveState.status==="dirty"?$(K):$(G,!1)},!0)}m(M,b)};H(_,M=>{t.saveState.status==="draft"?M(h):M(g,!1)})}var y=v(_,2);{var E=M=>{var b=cd(),P=c(b);o(b),j(K=>O(P,`saved at ${K??""}`),[()=>n(t.saveState.lastSaved)]),m(M,b)};H(y,M=>{t.saveState.lastSaved&&(t.saveState.status==="clean"||t.saveState.status==="draft")&&M(E)})}var z=v(y,2);{var B=M=>{var b=ud();b.__click=function(...P){t.onSave?.apply(this,P)},j(()=>b.disabled=t.saveState.status==="clean"||t.saveState.status==="draft"||t.saveState.status==="saving"),m(M,b)};H(z,M=>{t.onSave&&M(B)})}o(l);var q=v(l,2);{var N=M=>{var b=dd(),P=c(b,!0);o(b),j(()=>O(P,t.saveState.error)),m(M,b)};H(q,M=>{t.saveState.status==="error"&&t.saveState.error&&M(N)})}o(s),j(()=>U(s,"data-status",t.saveState.status)),m(e,s),Pt()}Bt(["click"]);function hd(e,t){qt(t,!0);let n=It(t,"showDialog",15,!1),r=st(null),i=st(!1);Xt(()=>(t.saveState.status==="dirty"?window.onbeforeunload=_=>(_.preventDefault(),_.returnValue="",""):window.onbeforeunload=null,()=>{window.onbeforeunload=null})),vr(({to:f,cancel:_})=>{if(a(i)){p(i,!1);return}t.saveState.status==="dirty"&&f&&(_(),p(r,{url:f.url.pathname},!0),n(!0),t.onShowDialog?.(!0))});function s(){if(a(r)){const f=a(r).url;p(r,null),n(!1),t.onShowDialog?.(!1),t.onNavigationAllowed?.(),p(i,!0),fr(f)}}function l(){p(r,null),n(!1),t.onShowDialog?.(!1)}var d={allowNavigation:s,cancelNavigation:l};return Pt(d)}function _d(e,t){e.target===e.currentTarget&&t.onCancel?.()}function gd(e,t){(e.key==="Enter"||e.key===" ")&&e.target===e.currentTarget&&(e.preventDefault(),t.onCancel?.())}var md=C('<div class="dialog-overlay svelte-1nrguxe" role="dialog" aria-modal="true" aria-labelledby="navigation-dialog-title" tabindex="-1"><div class="dialog-content svelte-1nrguxe"><h2 id="navigation-dialog-title" class="svelte-1nrguxe">You have unsaved changes</h2> <p class="svelte-1nrguxe">You have unsaved changes. Are you sure you want to leave?</p> <div class="dialog-actions svelte-1nrguxe"><button type="button" class="button-save svelte-1nrguxe">Save Changes</button> <button type="button" class="button-discard svelte-1nrguxe">Discard Changes</button> <button type="button" class="button-cancel svelte-1nrguxe">Cancel</button></div></div></div>');function pd(e,t){qt(t,!0);function n(l){l.key==="Escape"&&t.isOpen&&t.onCancel?.()}var r=Et();ge("keydown",Pe,n);var i=gt(r);{var s=l=>{var d=md();d.__click=[_d,t],d.__keydown=[gd,t];var f=c(d),_=v(c(f),4),h=c(_);h.__click=function(...E){t.onSave?.apply(this,E)};var g=v(h,2);g.__click=function(...E){t.onDiscard?.apply(this,E)};var y=v(g,2);y.__click=function(...E){t.onCancel?.apply(this,E)},o(_),o(f),o(d),m(l,d)};H(i,l=>{t.isOpen&&l(s)})}m(e,r),Pt()}Bt(["click","keydown"]);function yd(e,t){e.target===e.currentTarget&&t.onClose()}var bd=C("<strong> </strong>"),wd=C('<li class="svelte-pna667"> </li>'),xd=C('<div class="suggestions svelte-pna667"><strong>Suggestions:</strong> <ul class="svelte-pna667"></ul></div>'),kd=C('<li class="error-item svelte-pna667"><div class="issue-message svelte-pna667"><!> </div> <!></li>'),Sd=C('<div class="issue-group svelte-pna667"><h4 class="svelte-pna667"> </h4> <ul class="svelte-pna667"></ul></div>'),Cd=C('<section class="errors-section svelte-pna667"><h3 class="svelte-pna667"> </h3> <p class="section-description svelte-pna667">These issues must be fixed before deployment:</p> <!></section>'),Ed=C("<strong> </strong>"),Td=C('<li class="svelte-pna667"> </li>'),Nd=C('<div class="suggestions svelte-pna667"><strong>Suggestions:</strong> <ul class="svelte-pna667"></ul></div>'),Ad=C('<li class="warning-item svelte-pna667"><div class="issue-message svelte-pna667"><!> </div> <!></li>'),Md=C('<div class="issue-group svelte-pna667"><h4 class="svelte-pna667"> </h4> <ul class="svelte-pna667"></ul></div>'),zd=C(`<section class="warnings-section svelte-pna667"><h3 class="svelte-pna667"> </h3> <p class="section-description svelte-pna667">These issues won't block deployment but should be reviewed:</p> <!></section>`),Dd=C('<div class="dialog-overlay svelte-pna667" role="dialog" aria-modal="true" aria-labelledby="dialog-title" tabindex="-1"><div class="dialog-content svelte-pna667"><header class="dialog-header svelte-pna667"><h2 id="dialog-title" class="svelte-pna667">Flow Validation Failed</h2> <button class="close-button svelte-pna667" aria-label="Close dialog">Ã—</button></header> <div class="dialog-body svelte-pna667"><!> <!></div> <footer class="dialog-footer svelte-pna667"><button class="primary-button svelte-pna667">Close and Edit Flow</button></footer></div></div>');function Rd(e,t){qt(t,!0);let n=st(void 0);function r(h){h.key==="Escape"&&t.isOpen&&t.onClose()}Xt(()=>{t.isOpen&&a(n)&&a(n).querySelector(".primary-button")?.focus()});function i(h){const g=new De;for(const y of h){const E=y.component_name;g.has(E)||g.set(E,[]),g.get(E).push(y)}return g}let s=rt(()=>t.validationResult?i(t.validationResult.errors):new De),l=rt(()=>t.validationResult?i(t.validationResult.warnings):new De);var d=Et();ge("keydown",Pe,r);var f=gt(d);{var _=h=>{var g=Dd();g.__click=[yd,t],g.__keydown=r;var y=c(g),E=c(y),z=v(c(E),2);z.__click=function(...G){t.onClose?.apply(this,G)},o(E);var B=v(E,2),q=c(B);{var N=G=>{var $=Cd(),L=c($),W=c(L);o(L);var X=v(L,4);Ct(X,17,()=>[...a(s).entries()],([F,A])=>F,(F,A)=>{var x=rt(()=>Ee(a(A),2));let u=()=>a(x)[0],S=()=>a(x)[1];var w=Sd(),T=c(w),k=c(T,!0);o(T);var D=v(T,2);Ct(D,23,S,(R,V)=>`${R.component_name}-${R.port_name||"main"}-${R.type}-${V}`,(R,V)=>{var tt=kd(),nt=c(tt),at=c(nt);{var ot=Q=>{var et=bd(),ct=c(et);o(et),j(()=>O(ct,`${a(V).port_name??""}:`)),m(Q,et)};H(at,Q=>{a(V).port_name&&Q(ot)})}var I=v(at);o(nt);var Y=v(nt,2);{var lt=Q=>{var et=xd(),ct=v(c(et),2);Ct(ct,23,()=>a(V).suggestions,(mt,Z)=>`${a(V).component_name}-${a(V).type}-suggestion-${Z}`,(mt,Z)=>{var dt=wd(),ht=c(dt,!0);o(dt),j(()=>O(ht,a(Z))),m(mt,dt)}),o(ct),o(et),m(Q,et)};H(Y,Q=>{a(V).suggestions&&a(V).suggestions.length>0&&Q(lt)})}o(tt),j(()=>O(I,` ${a(V).message??""}`)),m(R,tt)}),o(D),o(w),j(()=>O(k,u())),m(F,w)}),o($),j(()=>O(W,`âŒ Errors (${t.validationResult.errors.length??""})`)),m(G,$)};H(q,G=>{t.validationResult.errors.length>0&&G(N)})}var M=v(q,2);{var b=G=>{var $=zd(),L=c($),W=c(L);o(L);var X=v(L,4);Ct(X,17,()=>[...a(l).entries()],([F,A])=>F,(F,A)=>{var x=rt(()=>Ee(a(A),2));let u=()=>a(x)[0],S=()=>a(x)[1];var w=Md(),T=c(w),k=c(T,!0);o(T);var D=v(T,2);Ct(D,23,S,(R,V)=>`${R.component_name}-${R.port_name||"main"}-${R.type}-${V}`,(R,V)=>{var tt=Ad(),nt=c(tt),at=c(nt);{var ot=Q=>{var et=Ed(),ct=c(et);o(et),j(()=>O(ct,`${a(V).port_name??""}:`)),m(Q,et)};H(at,Q=>{a(V).port_name&&Q(ot)})}var I=v(at);o(nt);var Y=v(nt,2);{var lt=Q=>{var et=Nd(),ct=v(c(et),2);Ct(ct,23,()=>a(V).suggestions,(mt,Z)=>`${a(V).component_name}-${a(V).type}-suggestion-${Z}`,(mt,Z)=>{var dt=Td(),ht=c(dt,!0);o(dt),j(()=>O(ht,a(Z))),m(mt,dt)}),o(ct),o(et),m(Q,et)};H(Y,Q=>{a(V).suggestions&&a(V).suggestions.length>0&&Q(lt)})}o(tt),j(()=>O(I,` ${a(V).message??""}`)),m(R,tt)}),o(D),o(w),j(()=>O(k,u())),m(F,w)}),o($),j(()=>O(W,`âš ï¸ Warnings (${t.validationResult.warnings.length??""})`)),m(G,$)};H(M,G=>{t.validationResult.warnings.length>0&&G(b)})}o(B);var P=v(B,2),K=c(P);K.__click=function(...G){t.onClose?.apply(this,G)},o(P),o(y),o(g),ne(g,G=>p(n,G),()=>a(n)),m(h,g)};H(f,h=>{t.isOpen&&t.validationResult&&h(_)})}m(e,d),Pt()}Bt(["click","keydown"]);function qd(e,t){e.target===e.currentTarget&&t.onClose()}var Pd=C("<strong> </strong>"),Od=C('<div class="suggestion svelte-11plyrw"><strong>ðŸ’¡ Suggestion:</strong> </div>'),Id=C('<li class="error-item svelte-11plyrw"><div class="error-detail svelte-11plyrw"><!> </div> <!></li>'),Fd=C('<div class="error-group svelte-11plyrw"><h4 class="svelte-11plyrw"> </h4> <ul class="svelte-11plyrw"></ul></div>'),Ld=C(`<div class="modal-overlay svelte-11plyrw" role="dialog" aria-modal="true" aria-labelledby="modal-title" tabindex="-1"><div class="modal-content svelte-11plyrw"><header class="modal-header svelte-11plyrw"><h2 id="modal-title" class="svelte-11plyrw">Cannot Deploy Flow</h2> <button class="close-button svelte-11plyrw" aria-label="Close modal">Ã—</button></header> <div class="modal-body svelte-11plyrw"><div class="error-summary svelte-11plyrw"><span class="error-icon svelte-11plyrw">âŒ</span> <p class="error-message svelte-11plyrw">This flow has <strong> </strong> that must
						be fixed before deployment.</p></div> <section class="errors-section svelte-11plyrw"><h3 class="svelte-11plyrw">Errors to Fix:</h3> <!></section></div> <footer class="modal-footer svelte-11plyrw"><button class="primary-button svelte-11plyrw">OK, I'll Fix These Errors</button></footer></div></div>`);function Vd(e,t){qt(t,!0);let n=st(void 0);function r(h){h.key==="Escape"&&t.isOpen&&t.onClose()}Xt(()=>{t.isOpen&&a(n)&&a(n).querySelector(".primary-button")?.focus()});const i=rt(()=>{if(!t.validationResult)return new De;const h=new De;for(const g of t.validationResult.errors){const y=g.component_name;h.has(y)||h.set(y,[]),h.get(y).push(g)}return h}),s=rt(()=>Array.from(a(i).entries())),l=rt(()=>t.validationResult?.errors.length||0);var d=Et();ge("keydown",Pe,r);var f=gt(d);{var _=h=>{var g=Ld();g.__click=[qd,t],g.__keydown=r;var y=c(g),E=c(y),z=v(c(E),2);z.__click=function(...L){t.onClose?.apply(this,L)},o(E);var B=v(E,2),q=c(B),N=v(c(q),2),M=v(c(N)),b=c(M);o(M),Hn(),o(N),o(q);var P=v(q,2),K=v(c(P),2);Ct(K,17,()=>a(s),([L,W])=>L,(L,W)=>{var X=rt(()=>Ee(a(W),2));let F=()=>a(X)[0],A=()=>a(X)[1];var x=Fd(),u=c(x),S=c(u,!0);o(u);var w=v(u,2);Ct(w,21,A,T=>T.port_name?`${F()}-${T.port_name}`:`${F()}-${T.message}`,(T,k)=>{var D=Id(),R=c(D),V=c(R);{var tt=I=>{var Y=Pd(),lt=c(Y);o(Y),j(()=>O(lt,`${a(k).port_name??""}:`)),m(I,Y)};H(V,I=>{a(k).port_name&&I(tt)})}var nt=v(V);o(R);var at=v(R,2);{var ot=I=>{var Y=Et(),lt=gt(Y);Ct(lt,16,()=>a(k).suggestions,Q=>Q,(Q,et)=>{var ct=Od(),mt=v(c(ct));o(ct),j(()=>O(mt,` ${et??""}`)),m(Q,ct)}),m(I,Y)};H(at,I=>{a(k).suggestions&&a(k).suggestions.length>0&&I(ot)})}o(D),j(()=>O(nt,` ${a(k).message??""}`)),m(T,D)}),o(w),o(x),j(()=>O(S,F())),m(L,x)}),o(P),o(B);var G=v(B,2),$=c(G);$.__click=function(...L){t.onClose?.apply(this,L)},o(G),o(y),o(g),ne(g,L=>p(n,L),()=>a(n)),j(()=>O(b,`${a(l)??""} error${a(l)>1?"s":""}`)),m(h,g)};H(f,h=>{t.isOpen&&t.validationResult&&a(l)>0&&h(_)})}m(e,d),Pt()}Bt(["click","keydown"]);function ka(e,t){e.target===e.currentTarget&&t.onClose()}function Sa(e,t){(e.key==="Enter"||e.key===" ")&&e.target===e.currentTarget&&(e.preventDefault(),t.onClose())}var Hd=e=>e.stopPropagation(),Bd=e=>e.stopPropagation(),jd=C('<span class="port-name svelte-10mzki"> </span>'),Xd=C('<div class="issue-suggestion svelte-10mzki"><span class="suggestion-icon svelte-10mzki">ðŸ’¡</span> </div>'),Ud=C('<li class="issue-item error-item svelte-10mzki"><div class="issue-header svelte-10mzki"><strong class="component-name svelte-10mzki"> </strong> <!></div> <div class="issue-message svelte-10mzki"> </div> <!></li>'),Yd=C('<section class="issues-section errors-section svelte-10mzki"><h3 class="section-title svelte-10mzki"><span class="section-icon svelte-10mzki">âŒ</span> </h3> <ul class="issues-list svelte-10mzki"></ul></section>'),Wd=C('<span class="port-name svelte-10mzki"> </span>'),Kd=C('<div class="issue-suggestion svelte-10mzki"><span class="suggestion-icon svelte-10mzki">ðŸ’¡</span> </div>'),Gd=C('<li class="issue-item warning-item svelte-10mzki"><div class="issue-header svelte-10mzki"><strong class="component-name svelte-10mzki"> </strong> <!></div> <div class="issue-message svelte-10mzki"> </div> <!></li>'),Jd=C('<section class="issues-section warnings-section svelte-10mzki"><h3 class="section-title svelte-10mzki"><span class="section-icon svelte-10mzki">âš ï¸</span> </h3> <ul class="issues-list svelte-10mzki"></ul></section>'),Zd=C('<div class="empty-state svelte-10mzki"><p class="svelte-10mzki">No validation issues found.</p></div>'),Qd=C('<div class="modal-backdrop svelte-10mzki" data-testid="modal-backdrop" role="presentation"><div class="modal-dialog svelte-10mzki" role="dialog" aria-label="Validation Details" tabindex="0"><div class="modal-header svelte-10mzki"><h2 class="svelte-10mzki">Validation Issues</h2> <button type="button" class="close-button svelte-10mzki" aria-label="Close">âœ•</button></div> <div class="modal-body svelte-10mzki"><!> <!> <!></div> <div class="modal-footer svelte-10mzki"><button type="button" class="button-primary svelte-10mzki">Close</button></div></div></div>'),$d=e=>e.stopPropagation(),tv=e=>e.stopPropagation(),ev=C('<div class="modal-backdrop svelte-10mzki" data-testid="modal-backdrop" role="presentation"><div class="modal-dialog svelte-10mzki" role="dialog" aria-label="Validation Details" tabindex="0"><div class="modal-header svelte-10mzki"><h2 class="svelte-10mzki">Validation Details</h2> <button type="button" class="close-button svelte-10mzki" aria-label="Close">âœ•</button></div> <div class="modal-body svelte-10mzki"><div class="empty-state svelte-10mzki"><p class="svelte-10mzki">No validation results available.</p></div></div> <div class="modal-footer svelte-10mzki"><button type="button" class="button-primary svelte-10mzki">Close</button></div></div></div>');function nv(e,t){qt(t,!0);let n=st(null),r=null;function i(h,g){if(t.validationResult?.nodes){if(h&&h.trim()!==""){const y=t.validationResult.nodes.find(E=>E.id===h);if(y)return y.name||y.id}if(g){const y=t.validationResult.nodes.find(E=>E.input_ports?.some(z=>z.name===g)||E.output_ports?.some(z=>z.name===g));if(y)return y.name||y.id}}return h&&h.trim()!==""?h:"Flow"}function s(h){if(h.key==="Escape"&&t.isOpen){t.onClose();return}if(h.key==="Tab"&&t.isOpen&&a(n)){const g=a(n).querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),y=Array.from(g);if(y.length===0)return;const E=y[0],z=y[y.length-1];h.shiftKey?document.activeElement===E&&(h.preventDefault(),z.focus()):document.activeElement===z&&(h.preventDefault(),E.focus())}}Xt(()=>{if(t.isOpen)return r=document.activeElement,document.addEventListener("keydown",s),setTimeout(()=>{if(a(n)){const h=a(n).querySelector("button");h?h.focus():a(n).focus()}},10),()=>{document.removeEventListener("keydown",s),r&&r.focus()}});var l=Et(),d=gt(l);{var f=h=>{var g=Qd();g.__click=[ka,t],g.__keydown=[Sa,t];var y=c(g);y.__click=[Hd],y.__keydown=[Bd];var E=c(y),z=v(c(E),2);z.__click=function(...L){t.onClose?.apply(this,L)},o(E);var B=v(E,2),q=c(B);{var N=L=>{var W=Yd(),X=c(W),F=v(c(X));o(X);var A=v(X,2);Ct(A,23,()=>t.validationResult.errors,(x,u)=>x.component_name+"|"+(x.port_name??"")+"|"+x.message+"|"+u,(x,u)=>{var S=Ud(),w=c(S),T=c(w),k=c(T,!0);o(T);var D=v(T,2);{var R=ot=>{var I=jd(),Y=c(I);o(I),j(()=>O(Y,`Port: ${a(u).port_name??""}`)),m(ot,I)};H(D,ot=>{a(u).port_name&&ot(R)})}o(w);var V=v(w,2),tt=c(V,!0);o(V);var nt=v(V,2);{var at=ot=>{var I=Xd(),Y=v(c(I));o(I),j(()=>O(Y,` ${a(u).suggestions[0]??""}`)),m(ot,I)};H(nt,ot=>{a(u).suggestions&&a(u).suggestions.length>0&&ot(at)})}o(S),j(ot=>{O(k,ot),O(tt,a(u).message)},[()=>i(a(u).component_name,a(u).port_name)]),m(x,S)}),o(A),o(W),j(()=>O(F,` Errors (${t.validationResult.errors.length??""})`)),m(L,W)};H(q,L=>{t.validationResult.errors.length>0&&L(N)})}var M=v(q,2);{var b=L=>{var W=Jd(),X=c(W),F=v(c(X));o(X);var A=v(X,2);Ct(A,23,()=>t.validationResult.warnings,(x,u)=>x.component_name+"|"+(x.port_name??"")+"|"+x.message+"|"+u,(x,u)=>{var S=Gd(),w=c(S),T=c(w),k=c(T,!0);o(T);var D=v(T,2);{var R=ot=>{var I=Wd(),Y=c(I);o(I),j(()=>O(Y,`Port: ${a(u).port_name??""}`)),m(ot,I)};H(D,ot=>{a(u).port_name&&ot(R)})}o(w);var V=v(w,2),tt=c(V,!0);o(V);var nt=v(V,2);{var at=ot=>{var I=Kd(),Y=v(c(I));o(I),j(()=>O(Y,` ${a(u).suggestions[0]??""}`)),m(ot,I)};H(nt,ot=>{a(u).suggestions&&a(u).suggestions.length>0&&ot(at)})}o(S),j(ot=>{O(k,ot),O(tt,a(u).message)},[()=>i(a(u).component_name,a(u).port_name)]),m(x,S)}),o(A),o(W),j(()=>O(F,` Warnings (${t.validationResult.warnings.length??""})`)),m(L,W)};H(M,L=>{t.validationResult.warnings.length>0&&L(b)})}var P=v(M,2);{var K=L=>{var W=Zd();m(L,W)};H(P,L=>{t.validationResult.errors.length===0&&t.validationResult.warnings.length===0&&L(K)})}o(B);var G=v(B,2),$=c(G);$.__click=function(...L){t.onClose?.apply(this,L)},o(G),o(y),ne(y,L=>p(n,L),()=>a(n)),o(g),m(h,g)},_=h=>{var g=Et(),y=gt(g);{var E=z=>{var B=ev();B.__click=[ka,t],B.__keydown=[Sa,t];var q=c(B);q.__click=[$d],q.__keydown=[tv];var N=c(q),M=v(c(N),2);M.__click=function(...K){t.onClose?.apply(this,K)},o(N);var b=v(N,4),P=c(b);P.__click=function(...K){t.onClose?.apply(this,K)},o(b),o(q),ne(q,K=>p(n,K),()=>a(n)),o(B),m(z,B)};H(y,z=>{t.isOpen&&!t.validationResult&&z(E)},!0)}m(h,g)};H(d,h=>{t.isOpen&&t.validationResult?h(f):h(_,!1)})}m(e,l),Pt()}Bt(["click","keydown"]);function av(e,t){const n=e.target;p(t,n.value,!0)}function rv(e,t,n){(e.ctrlKey||e.metaKey)&&e.key==="Enter"&&(e.preventDefault(),t()),e.key==="Escape"&&(e.preventDefault(),n())}var iv=C('<div class="validation-message error svelte-1mc16ro" role="alert"> </div>'),sv=C('<span class="spinner svelte-1mc16ro" role="status" aria-label="Loading"></span>'),ov=C('<div class="ai-prompt-input svelte-1mc16ro"><div class="input-container svelte-1mc16ro"><textarea aria-label="Describe your flow in natural language" rows="5" class="svelte-1mc16ro"></textarea> <!> <div class="character-count svelte-1mc16ro" aria-live="polite"><span> <!></span></div></div> <div class="actions svelte-1mc16ro"><button type="button" class="primary svelte-1mc16ro"><!> </button> <button type="button" class="svelte-1mc16ro">Cancel</button></div></div>');function lv(e,t){qt(t,!0);let n=It(t,"disabled",3,!1),r=It(t,"loading",3,!1),i=It(t,"placeholder",3,"Describe your flow in natural language..."),s=It(t,"maxLength",3,2e3),l=st(""),d=st(null),f=rt(()=>a(l).trim()),_=rt(()=>a(l).length),h=rt(()=>a(f).length>0&&a(_)<=s()),g=rt(()=>!a(h)||n()||r()),y=rt(()=>a(_)>=s()*.95),E=rt(()=>a(_)>=s()),z=rt(()=>a(_)>s()),B=rt(()=>r()?"Generating...":"Generate Flow");function q(){a(g)||t.onSubmit&&t.onSubmit(a(f))}function N(){p(l,""),t.onCancel&&t.onCancel()}var M=ov(),b=c(M),P=c(b);wr(P),P.__input=[av,l],P.__keydown=[rv,q,N],ne(P,D=>p(d,D),()=>a(d));var K=v(P,2);{var G=D=>{var R=iv(),V=c(R);o(R),j(()=>O(V,`Prompt exceeds maximum length of ${s()??""} characters`)),m(D,R)};H(K,D=>{a(z)&&D(G)})}var $=v(K,2),L=c($);let W;var X=c(L,!0),F=v(X);{var A=D=>{var R=xr();j(()=>O(R,`/ ${s()??""}`)),m(D,R)};H(F,D=>{s()&&D(A)})}o(L),o($),o(b);var x=v(b,2),u=c(x);u.__click=q;var S=c(u);{var w=D=>{var R=sv();m(D,R)};H(S,D=>{r()&&D(w)})}var T=v(S);o(u);var k=v(u,2);k.__click=N,o(x),o(M),j(D=>{Tr(P,a(l)),U(P,"placeholder",i()),P.disabled=n()||r(),U(P,"aria-disabled",n()||r()),W=Ht(L,1,"svelte-1mc16ro",null,W,D),O(X,a(_)),u.disabled=a(g),U(u,"aria-busy",r()),O(T,` ${a(B)??""}`),k.disabled=n()||r()},[()=>({warning:a(y),error:a(E)&&!a(z)})]),m(e,M),Pt()}Bt(["input","keydown","click"]);function cv(e,t,n){e.target===e.currentTarget&&!t()&&n()}function uv(e,t,n){a(t)&&n.onApply&&n.onApply()}function dv(e,t){t.onReject&&t.onReject()}function Ca(e,t){t.onRetry&&t.onRetry()}var vv=e=>e.stopPropagation(),fv=C('<div class="loading-state svelte-1f3rfsi" role="status" aria-live="polite"><div class="spinner svelte-1f3rfsi"></div> <p>Generating flow...</p></div>'),hv=C('<div class="error-state svelte-1f3rfsi" role="alert"><div class="error-icon svelte-1f3rfsi">âš ï¸</div> <h3 class="svelte-1f3rfsi">Error</h3> <p> </p></div>'),_v=C('<section class="flow-description svelte-1f3rfsi"><p> </p></section>'),gv=C('<p class="empty-state svelte-1f3rfsi">No components in this flow</p>'),mv=C('<div class="config-item svelte-1f3rfsi"> </div>'),pv=C('<div class="node-config svelte-1f3rfsi"></div>'),yv=C('<li class="svelte-1f3rfsi"><div><strong class="node-name"> </strong> <span class="node-type svelte-1f3rfsi"> </span></div> <!></li>'),bv=C('<ul class="node-list svelte-1f3rfsi"></ul>'),wv=C('<p class="empty-state svelte-1f3rfsi">No connections in this flow</p>'),xv=C('<li class="svelte-1f3rfsi"> </li>'),kv=C('<ul class="connection-list svelte-1f3rfsi"></ul>'),Sv=C('<div class="validation-success svelte-1f3rfsi"><span class="icon svelte-1f3rfsi">âœ“</span> <span>Flow is valid</span></div>'),Cv=C('<span class="port-name svelte-1f3rfsi"> </span>'),Ev=C('<li data-severity="error" class="svelte-1f3rfsi"><strong> </strong> <!> </li>'),Tv=C('<div class="validation-errors svelte-1f3rfsi"><h4 class="svelte-1f3rfsi"><span class="icon">âœ—</span> </h4> <ul class="svelte-1f3rfsi"></ul></div>'),Nv=C('<span class="port-name svelte-1f3rfsi"> </span>'),Av=C('<li data-severity="warning" class="svelte-1f3rfsi"><strong> </strong> <!> </li>'),Mv=C('<div class="validation-warnings svelte-1f3rfsi"><h4 class="svelte-1f3rfsi"><span class="icon">âš </span> </h4> <ul class="svelte-1f3rfsi"></ul></div>'),zv=C('<section class="validation-section svelte-1f3rfsi"><h3 class="svelte-1f3rfsi">Validation</h3> <!> <!> <!></section>'),Dv=C('<!> <section class="flow-section svelte-1f3rfsi"><h3 class="svelte-1f3rfsi"> </h3> <!></section> <section class="flow-section svelte-1f3rfsi"><h3 class="svelte-1f3rfsi"> </h3> <!></section> <!>',1),Rv=C('<div class="empty-state svelte-1f3rfsi"><p>No flow to preview</p></div>'),qv=C('<button type="button" class="svelte-1f3rfsi">Retry</button>'),Pv=C('<button type="button" class="primary svelte-1f3rfsi">Apply to Canvas</button> <button type="button" class="svelte-1f3rfsi">Reject</button> <button type="button" class="svelte-1f3rfsi">Retry</button>',1),Ov=C('<div class="modal-backdrop backdrop svelte-1f3rfsi" role="presentation"><dialog open aria-modal="true" aria-label="Generated Flow Preview" class="svelte-1f3rfsi"><article class="svelte-1f3rfsi"><header class="svelte-1f3rfsi"><h2 class="svelte-1f3rfsi">Generated Flow Preview</h2> <button type="button" class="close svelte-1f3rfsi" aria-label="Close">âœ•</button></header> <div class="modal-content svelte-1f3rfsi"><!></div> <footer class="svelte-1f3rfsi"><!></footer></article></dialog></div>');function Iv(e,t){qt(t,!0);let n=It(t,"isOpen",3,!1),r=It(t,"flow",3,null),i=It(t,"validationResult",3,null),s=It(t,"loading",3,!1),l=It(t,"error",3,null),d=rt(()=>i()?.errors&&i().errors.length>0),f=rt(()=>i()?.warnings&&i().warnings.length>0),_=rt(()=>i()?.validation_status==="valid"),h=rt(()=>!a(d)&&r()!==null&&!s()),g=rt(()=>r()?.nodes?.length??0),y=rt(()=>r()?.connections?.length??0);function E(b){b.key==="Escape"&&!s()&&z()}function z(){t.onClose&&t.onClose()}function B(b){const P=r()?.nodes?.find(G=>G.id===b.source_node_id)?.name||"Unknown",K=r()?.nodes?.find(G=>G.id===b.target_node_id)?.name||"Unknown";return`${P} (${b.source_port}) â†’ ${K} (${b.target_port})`}mn(()=>{const b=P=>{n()&&E(P)};return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}});var q=Et(),N=gt(q);{var M=b=>{var P=Ov();P.__click=[cv,s,z];var K=c(P);K.__click=[vv];var G=c(K),$=c(G),L=v(c($),2);L.__click=z,o($);var W=v($,2),X=c(W);{var F=T=>{var k=fv();m(T,k)},A=T=>{var k=Et(),D=gt(k);{var R=tt=>{var nt=hv(),at=v(c(nt),4),ot=c(at,!0);o(at),o(nt),j(()=>O(ot,l())),m(tt,nt)},V=tt=>{var nt=Et(),at=gt(nt);{var ot=Y=>{var lt=Dv(),Q=gt(lt);{var et=ft=>{var it=_v(),vt=c(it),pt=c(vt,!0);o(vt),o(it),j(()=>O(pt,r().description)),m(ft,it)};H(Q,ft=>{r().description&&ft(et)})}var ct=v(Q,2),mt=c(ct),Z=c(mt);o(mt);var dt=v(mt,2);{var ht=ft=>{var it=gv();m(ft,it)},_t=ft=>{var it=bv();Ct(it,23,()=>r().nodes,(vt,pt)=>vt.id||pt,(vt,pt)=>{var Rt=yv(),Ot=c(Rt),wt=c(Ot),Nt=c(wt,!0);o(wt);var At=v(wt,2),St=c(At);o(At),o(Ot);var bt=v(Ot,2);{var zt=Vt=>{var Kt=pv();Ct(Kt,21,()=>Object.entries(a(pt).config),([Ut,Wt])=>Ut,(Ut,Wt)=>{var Zt=rt(()=>Ee(a(Wt),2));let ye=()=>a(Zt)[0],se=()=>a(Zt)[1];var oe=mv(),de=c(oe);o(oe),j(Qt=>O(de,`${ye()??""}: ${Qt??""}`),[()=>JSON.stringify(se())]),m(Ut,oe)}),o(Kt),m(Vt,Kt)};H(bt,Vt=>{Object.keys(a(pt).config||{}).length>0&&Vt(zt)})}o(Rt),j(()=>{O(Nt,a(pt).name),O(St,`(${a(pt).type??""})`)}),m(vt,Rt)}),o(it),m(ft,it)};H(dt,ft=>{a(g)===0?ft(ht):ft(_t,!1)})}o(ct);var xt=v(ct,2),Tt=c(xt),Dt=c(Tt);o(Tt);var jt=v(Tt,2);{var Ft=ft=>{var it=wv();m(ft,it)},Yt=ft=>{var it=kv();Ct(it,23,()=>r().connections,(vt,pt)=>vt.id||pt,(vt,pt)=>{var Rt=xv(),Ot=c(Rt,!0);o(Rt),j(wt=>O(Ot,wt),[()=>B(a(pt))]),m(vt,Rt)}),o(it),m(ft,it)};H(jt,ft=>{a(y)===0?ft(Ft):ft(Yt,!1)})}o(xt);var Lt=v(xt,2);{var Mt=ft=>{var it=zv(),vt=v(c(it),2);{var pt=At=>{var St=Sv();m(At,St)};H(vt,At=>{a(_)&&At(pt)})}var Rt=v(vt,2);{var Ot=At=>{var St=Tv(),bt=c(St),zt=v(c(bt));o(bt);var Vt=v(bt,2);Ct(Vt,21,()=>i().errors,ea,(Kt,Ut)=>{var Wt=Ev(),Zt=c(Wt),ye=c(Zt,!0);o(Zt);var se=v(Zt,2);{var oe=Qt=>{var ve=Cv(),Ae=c(ve);o(ve),j(()=>O(Ae,`(${a(Ut).port_name??""})`)),m(Qt,ve)};H(se,Qt=>{a(Ut).port_name&&Qt(oe)})}var de=v(se);o(Wt),j(()=>{U(Wt,"data-node-id",a(Ut).component_name),O(ye,a(Ut).component_name),O(de,` : ${a(Ut).message??""}`)}),m(Kt,Wt)}),o(Vt),o(St),j(()=>O(zt,` ${i().errors.length??""} Error${i().errors.length!==1?"s":""}`)),m(At,St)};H(Rt,At=>{a(d)&&At(Ot)})}var wt=v(Rt,2);{var Nt=At=>{var St=Mv(),bt=c(St),zt=v(c(bt));o(bt);var Vt=v(bt,2);Ct(Vt,21,()=>i().warnings,ea,(Kt,Ut)=>{var Wt=Av(),Zt=c(Wt),ye=c(Zt,!0);o(Zt);var se=v(Zt,2);{var oe=Qt=>{var ve=Nv(),Ae=c(ve);o(ve),j(()=>O(Ae,`(${a(Ut).port_name??""})`)),m(Qt,ve)};H(se,Qt=>{a(Ut).port_name&&Qt(oe)})}var de=v(se);o(Wt),j(()=>{U(Wt,"data-node-id",a(Ut).component_name),O(ye,a(Ut).component_name),O(de,` : ${a(Ut).message??""}`)}),m(Kt,Wt)}),o(Vt),o(St),j(()=>O(zt,` ${i().warnings.length??""} Warning${i().warnings.length!==1?"s":""}`)),m(At,St)};H(wt,At=>{a(f)&&At(Nt)})}o(it),m(ft,it)};H(Lt,ft=>{i()&&ft(Mt)})}j(()=>{O(Z,`Components (${a(g)??""})`),O(Dt,`Connections (${a(y)??""})`)}),m(Y,lt)},I=Y=>{var lt=Rv();m(Y,lt)};H(at,Y=>{r()?Y(ot):Y(I,!1)},!0)}m(tt,nt)};H(D,tt=>{l()?tt(R):tt(V,!1)},!0)}m(T,k)};H(X,T=>{s()?T(F):T(A,!1)})}o(W);var x=v(W,2),u=c(x);{var S=T=>{var k=qv();k.__click=[Ca,t],m(T,k)},w=T=>{var k=Et(),D=gt(k);{var R=V=>{var tt=Pv(),nt=gt(tt);nt.__click=[uv,h,t];var at=v(nt,2);at.__click=[dv,t];var ot=v(at,2);ot.__click=[Ca,t],j(()=>nt.disabled=!a(h)),m(V,tt)};H(D,V=>{s()||V(R)},!0)}m(T,k)};H(u,T=>{l()?T(S):T(w,!1)})}o(x),o(G),o(K),o(P),j(()=>L.disabled=s()),m(b,P)};H(N,b=>{n()&&b(M)})}m(e,q),Pt()}Bt(["click"]);class er extends Error{constructor(t,n){super(t),this.validationResult=n,this.name="ValidationError"}}async function Fv(e,t){const n=await fetch(`/flowbuilder/flows/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const r=await n.json();throw new Error(r.error||"Save failed")}return await n.json()}async function Lv(e){const t=await fetch(`/flowbuilder/deployment/${e}/deploy`,{method:"POST"});if(!t.ok){const n=await t.json();throw n.validation_result?new er(n.error||"Flow validation failed",n.validation_result):new Error(n.error||"Deploy failed")}return await t.json()}async function Vv(e){const t=await fetch(`/flowbuilder/deployment/${e}/start`,{method:"POST"});if(!t.ok){const n=await t.json();throw new Error(n.error||"Start failed")}return await t.json()}async function Hv(e){const t=await fetch(`/flowbuilder/deployment/${e}/stop`,{method:"POST"});if(!t.ok){const n=await t.json();throw new Error(n.error||"Stop failed")}return await t.json()}function Bv(e){return e instanceof er}function an(e){return JSON.parse(JSON.stringify(e))}function jv(e=10){let t=[],n=-1;return{get history(){return t},get currentIndex(){return n},get maxSize(){return e},push(r){t=t.slice(0,n+1);const i=an(r);t.push(i),n++,t.length>e&&(t.shift(),n--)},pop(){if(!(n<=0))return n--,an(t[n])},redo(){if(!(n>=t.length-1))return n++,an(t[n])},getCurrent(){if(!(n<0||n>=t.length))return an(t[n])},canUndo(){return n>0},canRedo(){return n<t.length-1},clear(){t=[],n=-1},size(){return t.length}}}const Xv=jv(10);var Uv=C('<p class="svelte-1dk9wgy"> </p>'),Yv=C('<!> <!> <!> <!> <!> <!> <div class="editor-layout svelte-1dk9wgy"><aside class="palette-sidebar svelte-1dk9wgy"><!></aside> <main class="canvas-area svelte-1dk9wgy"><header class="editor-header svelte-1dk9wgy"><div class="header-content svelte-1dk9wgy"><a href="/" data-sveltekit-reload="" class="back-button svelte-1dk9wgy" aria-label="Back to flows">â† Flows</a> <div class="header-text svelte-1dk9wgy"><h1 class="svelte-1dk9wgy"> </h1> <!></div> <!></div></header> <div class="ai-prompt-section svelte-1dk9wgy"><!></div> <div class="canvas-container svelte-1dk9wgy"><!></div> <!> <!></main></div> <!> <!>',1);function ef(e,t){qt(t,!0);let n=st(Gt(t.data.flow)),r=st(!1),i=st(null),s=st(Gt([])),l=st(!1),d=st(!1),f=st(null),_=st(void 0),h=st(!1),g,y=st(!1),E=st(!1),z=st(null),B=st(!1),q=st(!1),N=st(!1),M=st(!1),b=st(null),P=st(null),K=st(null),G=st(""),$=st(null);const L=rt(()=>a($)?.validation_status!=="errors");let W=st(!1),X=st(Gt({status:"clean",lastSaved:null,error:null})),F=st(Gt({state:t.data.flow.runtime_state,message:null,lastTransition:null})),A=st(!1),x=300,u=st(Gt(a(n).nodes)),S=st(Gt(a(n).connections)),w=st(Gt({})),T=a(u).length,k=a(S).length,D=!1;mn(async()=>{try{const J=await fetch("/components/types");J.ok&&p(s,await J.json(),!0)}catch(J){console.error("Failed to fetch component types:",J)}});function R(J){const ut=a(u).find(yt=>yt.id===J);ut&&p(i,{...ut,health:{status:"not_running",lastUpdated:new Date().toISOString()}},!0)}Xt(()=>{const J=a(u).length,ut=a(S).length;if(!(J===T&&ut===k)){if(!D){T=J,k=ut,D=!0;return}p(r,!0),p(X,{...a(X),status:"dirty"},!0),T=J,k=ut}});let V=null,tt="";Xt(()=>{const J=a(u).map(kt=>kt.id).sort().join(","),ut=a(S).filter(kt=>kt.id.startsWith("conn_")).map(kt=>kt.id).sort().join(",");if(`${J}|${ut}`!==tt)return V&&clearTimeout(V),V=setTimeout(async()=>{const kt=await nt(a(n).id);if(p($,kt,!0),kt){ot(kt),at(kt);const te=a(u).map(Oe=>Oe.id).sort().join(","),ur=a(S).filter(Oe=>Oe.id.startsWith("conn_")).map(Oe=>Oe.id).sort().join(",");tt=`${te}|${ur}`,kt.validation_status==="errors"&&!a(r)&&a(X).status==="clean"?p(X,{status:"draft",lastSaved:a(X).lastSaved,error:`${kt.errors.length} error${kt.errors.length>1?"s":""}`,validationResult:kt},!0):kt.validation_status!=="errors"&&a(X).status==="draft"?p(X,{status:"clean",lastSaved:a(X).lastSaved,error:null,validationResult:kt},!0):p(X,{...a(X),validationResult:kt},!0)}},500),()=>{V&&clearTimeout(V)}});async function nt(J){try{const ut={id:J,name:a(n).name,runtime_state:a(n).runtime_state,nodes:a(u),connections:a(S)};console.log("[runFlowValidation] Sending node IDs to validation:",a(u).map(te=>te.id));const yt=await fetch(`/flowbuilder/flows/${J}/validate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ut)});return yt.ok?await yt.json():(console.error("Validation request failed:",yt.status,yt.statusText),null)}catch(ut){return console.error("Validation failed:",ut),null}}function at(J){if(p(S,a(S).filter(yt=>!yt.id.startsWith("auto_")),!0),!J.discovered_connections||J.discovered_connections.length===0)return;const ut=J.discovered_connections.map(yt=>{const te={id:`auto_${yt.source_node_id}_${yt.source_port}_${yt.target_node_id}_${yt.target_port}`,source_node_id:yt.source_node_id,source_port:yt.source_port,target_node_id:yt.target_node_id,target_port:yt.target_port,source:"auto",validationState:"valid"};return console.log("[updateAutoConnections] Created connection:",JSON.stringify(te,null,2)),te});console.log("[updateAutoConnections] Adding",ut.length,"auto connections"),p(S,[...a(S),...ut],!0),console.log("[updateAutoConnections] Total connections after update:",a(S).length)}function ot(J){if(J.nodes&&J.nodes.length>0){const ut={};for(const yt of J.nodes)ut[yt.id]={input_ports:yt.input_ports,output_ports:yt.output_ports};p(w,ut,!0)}J.errors.length>0&&p(S,a(S).map(ut=>J.errors.some(kt=>kt.component_name===ut.source_node_id||kt.component_name===ut.target_node_id)?{...ut,validationState:"error"}:ut),!0)}function I(J){R(J)}function Y(J){const ut=a(u).find(yt=>yt.id===J);ut&&(p(f,ut,!0),p(_,a(s).find(yt=>yt.id===ut.type),!0),p(d,!0))}function lt(J){p(u,a(u).filter(ut=>ut.id!==J),!0),p(S,a(S).filter(ut=>ut.source_node_id!==J&&ut.target_node_id!==J),!0),a(i)?.id===J&&p(i,null),p(r,!0),p(X,{...a(X),status:"dirty"},!0)}function Q(){p(l,!0)}function et(J,ut,yt){const te={id:`node_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,type:J.id,name:ut,position:{x:400+a(u).length%3*200,y:300+Math.floor(a(u).length/3)*150},config:yt};p(u,[...a(u),te],!0),p(l,!1),p(r,!0),p(X,{...a(X),status:"dirty"},!0)}function ct(){p(l,!1)}function mt(J,ut,yt){if(p(u,a(u).map(kt=>kt.id===J?{...kt,name:ut,config:yt}:kt),!0),p(d,!1),p(f,null),p(r,!0),p(X,{...a(X),status:"dirty"},!0),a(i)?.id===J){const kt=a(u).find(te=>te.id===J);kt&&p(i,{...kt,health:a(i).health},!0)}}function Z(J){lt(J),p(d,!1),p(f,null)}function dt(){p(d,!1),p(f,null)}async function ht(J){p(M,!0),p(K,null),p(G,J,!0);try{const ut=a(u).length>0?{id:a(n).id,nodes:a(u),connections:a(S)}:void 0,yt=await fetch("/api/ai/generate-flow",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:J,existingFlow:ut})});if(!yt.ok){const te=await yt.json();throw new Error(te.error||"Failed to generate flow")}const kt=await yt.json();p(b,kt.flow,!0),p(P,kt.validationResult,!0),p(N,!0)}catch(ut){p(K,ut instanceof Error?ut.message:"Failed to generate flow",!0),p(b,null),p(P,null),p(N,!0)}finally{p(M,!1)}}function _t(){a(b)&&(Xv.push({...a(n),nodes:a(u),connections:a(S)}),a(b).nodes&&p(u,[...a(b).nodes],!0),a(b).connections&&p(S,[...a(b).connections],!0),p(r,!0),p(X,{...a(X),status:"dirty"},!0),p(N,!1),p(b,null),p(P,null),p(K,null))}function xt(){p(N,!1),p(b,null),p(P,null),p(K,null)}async function Tt(){p(N,!1),a(G)&&await ht(a(G))}function Dt(){p(N,!1),p(b,null),p(P,null),p(K,null)}let jt=!1;async function Ft(){if(!jt){jt=!0,p(X,{...a(X),status:"saving"},!0);try{const J=await nt(a(n).id),ut=await Fv(a(n).id,{id:a(n).id,name:a(n).name,description:a(n).description,version:a(n).version,runtime_state:a(n).runtime_state,nodes:a(u),connections:a(S)});p(n,{...a(n),version:ut.version,runtime_state:ut.runtime_state,updated_at:ut.updated_at},!0),p(r,!1),J?.validation_status==="errors"?p(X,{status:"draft",lastSaved:new Date,error:`${J.errors.length} error${J.errors.length>1?"s":""}`,validationResult:J},!0):p(X,{status:"clean",lastSaved:new Date,error:null,validationResult:J},!0),a(F).state!==ut.runtime_state&&p(F,{state:ut.runtime_state,message:null,lastTransition:new Date},!0),a(W)&&(p(W,!1),await Yt()),a(y)&&(p(y,!1),g?.allowNavigation())}catch(J){const ut=J instanceof Error?J.message:"Save failed";p(X,{...a(X),status:"error",error:ut},!0),p(W,!1),p(y,!1)}finally{jt=!1}}}async function Yt(){if(a($)?.validation_status==="errors"){p(B,!0);return}if(a(r)){p(W,!0),await Ft();return}try{const J=await Lv(a(n).id);p(n,{...a(n),runtime_state:J.runtime_state,updated_at:J.updated_at},!0),p(F,{state:J.runtime_state,message:null,lastTransition:new Date},!0)}catch(J){if(Bv(J))p(z,J.validationResult,!0),p(E,!0),p(F,{...a(F),state:"not_deployed",message:null},!0);else{const ut=J instanceof Error?J.message:"Deploy failed";p(F,{...a(F),state:"error",message:ut},!0)}}}async function Lt(){try{const J=await Vv(a(n).id);p(n,{...a(n),runtime_state:J.runtime_state,updated_at:J.updated_at},!0),p(F,{state:J.runtime_state,message:null,lastTransition:new Date},!0)}catch(J){const ut=J instanceof Error?J.message:"Start failed";p(F,{...a(F),state:"error",message:ut},!0)}}async function Mt(){try{const J=await Hv(a(n).id);p(n,{...a(n),runtime_state:J.runtime_state,updated_at:J.updated_at},!0),p(F,{state:J.runtime_state,message:null,lastTransition:new Date},!0)}catch(J){const ut=J instanceof Error?J.message:"Stop failed";p(F,{...a(F),state:"error",message:ut},!0)}}async function ft(){p(y,!0),await Ft()}function it(){g?.allowNavigation()}function vt(){g?.cancelNavigation()}function pt(){p(E,!1),p(z,null)}function Rt(){p(B,!1)}function Ot(){p(q,!0)}function wt(){p(q,!1)}function Nt(){p(A,!a(A))}function At(){p(A,!1)}const St=70,bt=180,zt=50,Vt=rt(()=>a(A)?`calc(100vh - ${St}px - ${bt}px - ${zt}px - ${x}px)`:`calc(100vh - ${St}px - ${bt}px - ${zt}px)`);var Kt=Yv();kr(J=>{j(()=>Sr.title=`${(a(n)?.name||"Flow Editor")??""} - SemStreams`)});var Ut=gt(Kt);ne(hd(Ut,{get saveState(){return a(X)},get showDialog(){return a(h)},set showDialog(J){p(h,J,!0)}}),J=>g=J,()=>g);var Wt=v(Ut,2);pd(Wt,{get isOpen(){return a(h)},onSave:ft,onDiscard:it,onCancel:vt});var Zt=v(Wt,2);Rd(Zt,{get isOpen(){return a(E)},get validationResult(){return a(z)},onClose:pt});var ye=v(Zt,2);Vd(ye,{get isOpen(){return a(B)},get validationResult(){return a($)},onClose:Rt});var se=v(ye,2);nv(se,{get isOpen(){return a(q)},get validationResult(){return a($)},onClose:wt});var oe=v(se,2);Iv(oe,{get isOpen(){return a(N)},get flow(){return a(b)},get validationResult(){return a(P)},get loading(){return a(M)},get error(){return a(K)},onApply:_t,onReject:xt,onRetry:Tt,onClose:Dt});var de=v(oe,2),Qt=c(de),ve=c(Qt);{let J=rt(()=>a(i)?.id||null);Wl(ve,{get nodes(){return a(u)},get selectedNodeId(){return a(J)},onSelectNode:I,onEditNode:Y,onDeleteNode:lt,onAddComponent:Q})}o(Qt);var Ae=v(Qt,2),xn=c(Ae),Zn=c(xn),kn=v(c(Zn),2),Sn=c(kn),nr=c(Sn,!0);o(Sn);var ar=v(Sn,2);{var rr=J=>{var ut=Uv(),yt=c(ut,!0);o(ut),j(()=>O(yt,a(n).description)),m(J,ut)};H(ar,J=>{a(n)?.description&&J(rr)})}o(kn);var ir=v(kn,2);fd(ir,{get saveState(){return a(X)},onSave:Ft,get validationResult(){return a($)},onValidationClick:Ot}),o(Zn),o(xn);var Cn=v(xn,2),sr=c(Cn);lv(sr,{get loading(){return a(M)},get disabled(){return a(M)},onSubmit:ht}),o(Cn);var Ze=v(Cn,2),or=c(Ze);{let J=rt(()=>a(i)?.id||null);Rl(or,{get nodes(){return a(u)},get connections(){return a(S)},get portsMap(){return a(w)},get selectedNodeId(){return a(J)},onNodeClick:R})}o(Ze);var Qn=v(Ze,2);nu(Qn,{get runtimeState(){return a(F)},get isFlowValid(){return a(L)},get showRuntimePanel(){return a(A)},onDeploy:Yt,onStart:Lt,onStop:Mt,onToggleRuntimePanel:Nt});var lr=v(Qn,2);ad(lr,{get isOpen(){return a(A)},height:x,get flowId(){return a(n).id},onClose:At}),o(Ae),o(de);var $n=v(de,2);xc($n,{get isOpen(){return a(l)},get componentTypes(){return a(s)},onAdd:et,onClose:ct});var cr=v($n,2);Hc(cr,{get isOpen(){return a(d)},get node(){return a(f)},get componentType(){return a(_)},onSave:mt,onDelete:Z,onClose:dt}),j(()=>{O(nr,a(n)?.name||"Loading..."),me(Ze,`height: ${a(Vt)??""};`)}),m(e,Kt),Pt()}export{ef as component,tf as universal};
