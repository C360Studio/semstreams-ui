import"../chunks/DsnmJJEf.js";import{aB as I,Y as N,P as w,T as d,R as c,Z as O,V as l,W as n,d as u,Q as j,X as g,a9 as z,aU as D}from"../chunks/BkwaiKXi.js";import{i as E}from"../chunks/BnpdicBt.js";import{g as $}from"../chunks/Nne6mvNZ.js";import{e as J}from"../chunks/C9UW2KHr.js";import{s as L}from"../chunks/vE4479mo.js";const V=async({fetch:e})=>{try{const t=await e("/flowbuilder/flows");if(!t.ok)throw new Error(`Failed to load flows: ${t.statusText}`);return{flows:(await t.json()).flows||[]}}catch(t){return console.error("Failed to load flows:",t),{flows:[],error:t instanceof Error?t.message:"Failed to load flows"}}},nt=Object.freeze(Object.defineProperty({__proto__:null,load:V},Symbol.toStringTag,{value:"Module"}));var M=(e,t)=>t.onCreate?.(),Q=w('<div class="empty-state svelte-fcx454"><p>No flows yet. Create your first flow to get started.</p></div>'),R=(e,t,a)=>t.onFlowClick?.(u(a).id),W=w('<p class="description svelte-fcx454"> </p>'),X=w('<button class="flow-card svelte-fcx454"><h3 class="svelte-fcx454"> </h3> <!> <span> </span></button>'),Y=w('<div class="flow-grid svelte-fcx454"></div>'),Z=w('<div class="flow-list svelte-fcx454"><header class="svelte-fcx454"><h2>Flows</h2> <button aria-label="Create New Flow">Create New Flow</button></header> <!></div>');function q(e,t){N(t,!0);var a=Z(),s=l(a),i=d(l(s),2);i.__click=[M,t],n(s);var p=d(s,2);{var x=o=>{var r=Q();c(o,r)},y=o=>{var r=Y();J(r,21,()=>t.flows,v=>v.id,(v,f)=>{var _=X();_.__click=[R,t,f];var b=l(_),A=l(b,!0);n(b);var S=d(b,2);{var P=C=>{var T=W(),U=l(T,!0);n(T),j(()=>g(U,u(f).description)),c(C,T)};E(S,C=>{u(f).description&&C(P)})}var k=d(S,2),B=l(k,!0);n(k),n(_),j(()=>{g(A,u(f).name),L(k,1,`runtime-state ${u(f).runtime_state??""}`,"svelte-fcx454"),g(B,u(f).runtime_state)}),c(v,_)}),n(r),c(o,r)};E(p,o=>{t.flows.length===0?o(x):o(y,!1)})}n(a),c(e,a),O()}I(["click"]);const h="/flowbuilder/flows";class m extends Error{constructor(t,a,s){super(t),this.statusCode=a,this.details=s,this.name="FlowApiError"}}function F(e){return{...e,nodes:e.nodes||[],connections:e.connections||[],runtime_state:e.runtime_state}}const G={async createFlow(e){const t=await fetch(h,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const s=await t.json().catch(()=>({}));throw new m(`Failed to create flow: ${t.statusText}`,t.status,s)}const a=await t.json();return F(a)},async listFlows(){const e=await fetch(h);if(!e.ok)throw new m(`Failed to list flows: ${e.statusText}`,e.status);return(await e.json()).flows.map(F)},async getFlow(e){const t=await fetch(`${h}/${e}`);if(!t.ok)throw new m(`Failed to get flow: ${t.statusText}`,t.status);const a=await t.json();return F(a)},async updateFlow(e,t){const a=await fetch(`${h}/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!a.ok){const i=await a.json().catch(()=>({}));throw new m(`Failed to update flow: ${a.statusText}`,a.status,i)}const s=await a.json();return F(s)},async deleteFlow(e){const t=await fetch(`${h}/${e}`,{method:"DELETE"});if(!t.ok)throw new m(`Failed to delete flow: ${t.statusText}`,t.status)}};var H=w('<div class="error-banner svelte-1uha8ag"><strong class="svelte-1uha8ag">Error:</strong> </div>'),K=w('<main class="svelte-1uha8ag"><div class="page-header svelte-1uha8ag"><h1 class="svelte-1uha8ag">Visual Flow Builder</h1> <p class="svelte-1uha8ag">Create and manage semantic stream processing flows</p></div> <!> <!></main>');function lt(e,t){N(t,!0);async function a(){try{const o=await G.createFlow({name:`Flow ${new Date().toISOString()}`,description:"New flow created from UI"});await $(`/flows/${o.id}`)}catch(o){console.error("Failed to create flow:",o),alert("Failed to create flow: "+(o instanceof Error?o.message:"Unknown error"))}}function s(o){$(`/flows/${o}`)}var i=K();z(o=>{D.title="SemStreams - Flow Builder"});var p=d(l(i),2);{var x=o=>{var r=H(),v=d(l(r));n(r),j(()=>g(v,` ${t.data.error??""}`)),c(o,r)};E(p,o=>{t.data.error&&o(x)})}var y=d(p,2);q(y,{get flows(){return t.data.flows},onCreate:a,onFlowClick:s}),n(i),c(e,i),O()}export{lt as component,nt as universal};
